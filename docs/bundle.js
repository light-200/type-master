/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={63:(t,e)=>{function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}e.Q=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,s=this._callbacks["$"+t];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<s.length;r++)if((n=s[r])===e||n.fn===e){s.splice(r,1);break}return 0===s.length&&delete this._callbacks["$"+t],this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(n){s=0;for(var r=(n=n.slice(0)).length;s<r;++s)n[s].apply(this,e)}return this},n.prototype.emitReserved=n.prototype.emit,n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},10:t=>{function e(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(t){this.ms=t},e.prototype.setMax=function(t){this.max=t},e.prototype.setJitter=function(t){this.jitter=t}},306:function(t){!function(e){"use strict";var n=function(){return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var n,s;return(n="application/font-woff",s="image/jpeg",{woff:n,woff2:n,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:s,jpeg:s,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[e(t).toLowerCase()]||""},dataAsUrl:function(t,e){return"data:"+e+";base64,"+t},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise((function(e){t.toBlob(e)})):function(t){return new Promise((function(e){for(var n=window.atob(t.toDataURL().split(",")[1]),s=n.length,r=new Uint8Array(s),i=0;i<s;i++)r[i]=n.charCodeAt(i);e(new Blob([r],{type:"image/png"}))}))}(t)},resolveUrl:function(t,e){var n=document.implementation.createHTMLDocument(),s=n.createElement("base");n.head.appendChild(s);var r=n.createElement("a");return n.body.appendChild(r),s.href=e,r.href=t,r.href},getAndEncode:function(t){return c.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime()),new Promise((function(e){var n,s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var r=new FileReader;r.onloadend=function(){var t=r.result.split(/,/)[1];e(t)},r.readAsDataURL(s.response)}else n?e(n):i("cannot fetch resource: "+t+", status: "+s.status)},s.ontimeout=function(){n?e(n):i("timeout of 30000ms occured while fetching resource: "+t)},s.responseType="blob",s.timeout=3e4,s.open("GET",t,!0),s.send(),c.impl.options.imagePlaceholder){var r=c.impl.options.imagePlaceholder.split(/,/);r&&r[1]&&(n=r[1])}function i(t){console.error(t),e("")}}))},uid:(t=0,function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+t++}),delay:function(t){return function(e){return new Promise((function(n){setTimeout((function(){n(e)}),t)}))}},asArray:function(t){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e},escapeXhtml:function(t){return t.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(t){return new Promise((function(e,n){var s=new Image;s.onload=function(){e(s)},s.onerror=n,s.src=t}))},width:function(t){var e=n(t,"border-left-width"),s=n(t,"border-right-width");return t.scrollWidth+e+s},height:function(t){var e=n(t,"border-top-width"),s=n(t,"border-bottom-width");return t.scrollHeight+e+s}};var t;function e(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function n(t,e){var n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}}(),s=function(){var t=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(t,n,i){return e(t)?Promise.resolve(t).then(s).then((function(e){var s=Promise.resolve(t);return e.forEach((function(t){s=s.then((function(e){return r(e,t,n,i)}))})),s})):Promise.resolve(t)},shouldProcess:e,impl:{readUrls:s,inline:r}};function e(e){return-1!==e.search(t)}function s(e){for(var s,r=[];null!==(s=t.exec(e));)r.push(s[1]);return r.filter((function(t){return!n.isDataUrl(t)}))}function r(t,e,s,r){return Promise.resolve(e).then((function(t){return s?n.resolveUrl(t,s):t})).then(r||n.getAndEncode).then((function(t){return n.dataAsUrl(t,n.mimeType(e))})).then((function(s){return t.replace(function(t){return new RegExp("(url\\(['\"]?)("+n.escape(t)+")(['\"]?\\))","g")}(e),"$1"+s+"$3")}))}}(),r=function(){return{resolveAll:function(){return t(document).then((function(t){return Promise.all(t.map((function(t){return t.resolve()})))})).then((function(t){return t.join("\n")}))},impl:{readAll:t}};function t(){return Promise.resolve(n.asArray(document.styleSheets)).then((function(t){var e=[];return t.forEach((function(t){try{n.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}})),e})).then((function(t){return t.filter((function(t){return t.type===CSSRule.FONT_FACE_RULE})).filter((function(t){return s.shouldProcess(t.style.getPropertyValue("src"))}))})).then((function(e){return e.map(t)}));function t(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return s.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}}}(),i=function(){return{inlineAll:function e(r){return r instanceof Element?function(t){var e=t.style.getPropertyValue("background");return e?s.inlineAll(e).then((function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))})).then((function(){return t})):Promise.resolve(t)}(r).then((function(){return r instanceof HTMLImageElement?t(r).inline():Promise.all(n.asArray(r.childNodes).map((function(t){return e(t)})))})):Promise.resolve(r)},impl:{newImage:t}};function t(t){return{inline:function(e){return n.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||n.getAndEncode).then((function(e){return n.dataAsUrl(e,n.mimeType(t.src))})).then((function(e){return new Promise((function(n,s){t.onload=n,t.onerror=s,t.src=e}))}))}}}}(),o=void 0,a=!1,c={toSvg:u,toPng:function(t,e){return h(t,e||{}).then((function(t){return t.toDataURL()}))},toJpeg:function(t,e){return h(t,e=e||{}).then((function(t){return t.toDataURL("image/jpeg",e.quality||1)}))},toBlob:function(t,e){return h(t,e||{}).then(n.canvasToBlob)},toPixelData:function(t,e){return h(t,e||{}).then((function(e){return e.getContext("2d").getImageData(0,0,n.width(t),n.height(t)).data}))},impl:{fontFaces:r,images:i,util:n,inliner:s,options:{}}};function u(t,e){return function(t){void 0===t.imagePlaceholder?c.impl.options.imagePlaceholder=o:c.impl.options.imagePlaceholder=t.imagePlaceholder,void 0===t.cacheBust?c.impl.options.cacheBust=a:c.impl.options.cacheBust=t.cacheBust}(e=e||{}),Promise.resolve(t).then((function(t){return l(t,e.filter,!0)})).then(d).then(f).then((function(t){return e.bgcolor&&(t.style.backgroundColor=e.bgcolor),e.width&&(t.style.width=e.width+"px"),e.height&&(t.style.height=e.height+"px"),e.style&&Object.keys(e.style).forEach((function(n){t.style[n]=e.style[n]})),t})).then((function(s){return function(t,e,s){return Promise.resolve(t).then((function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(t)})).then(n.escapeXhtml).then((function(t){return'<foreignObject x="0" y="0" width="100%" height="100%">'+t+"</foreignObject>"})).then((function(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+s+'">'+t+"</svg>"})).then((function(t){return"data:image/svg+xml;charset=utf-8,"+t}))}(s,e.width||n.width(t),e.height||n.height(t))}))}function h(t,e){return u(t,e).then(n.makeImage).then(n.delay(100)).then((function(s){var r=function(t){var s=document.createElement("canvas");if(s.width=e.width||n.width(t),s.height=e.height||n.height(t),e.bgcolor){var r=s.getContext("2d");r.fillStyle=e.bgcolor,r.fillRect(0,0,s.width,s.height)}return s}(t);return r.getContext("2d").drawImage(s,0,0),r}))}function l(t,e,s){return s||!e||e(t)?Promise.resolve(t).then((function(t){return t instanceof HTMLCanvasElement?n.makeImage(t.toDataURL()):t.cloneNode(!1)})).then((function(s){return function(t,e,s){var r=t.childNodes;return 0===r.length?Promise.resolve(e):function(t,e,n){var s=Promise.resolve();return e.forEach((function(e){s=s.then((function(){return l(e,n)})).then((function(e){e&&t.appendChild(e)}))})),s}(e,n.asArray(r),s).then((function(){return e}))}(t,s,e)})).then((function(e){return function(t,e){return e instanceof Element?Promise.resolve().then((function(){s=window.getComputedStyle(t),r=e.style,s.cssText?r.cssText=s.cssText:function(t,e){n.asArray(t).forEach((function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))}))}(s,r);var s,r})).then((function(){[":before",":after"].forEach((function(s){!function(s){var r=window.getComputedStyle(t,s),i=r.getPropertyValue("content");if(""!==i&&"none"!==i){var o=n.uid();e.className=e.className+" "+o;var a=document.createElement("style");a.appendChild(function(t,e,s){var r="."+t+":"+e,i=s.cssText?o(s):a(s);return document.createTextNode(r+"{"+i+"}");function o(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}function a(t){return n.asArray(t).map(e).join("; ")+";";function e(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}}}(o,s,r)),e.appendChild(a)}}(s)}))})).then((function(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)})).then((function(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach((function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)})))})).then((function(){return e})):e}(t,e)})):Promise.resolve()}function d(t){return r.resolveAll().then((function(e){var n=document.createElement("style");return t.appendChild(n),n.appendChild(document.createTextNode(e)),t}))}function f(t){return i.inlineAll(t).then((function(){return t}))}t.exports=c}()},162:function(t,e,n){var s;void 0===(s=function(){"use strict";function e(t,e,n){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){a(s.response,e,n)},s.onerror=function(){console.error("could not download file")},s.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,n,o){var a=i.URL||i.webkitURL,c=document.createElement("a");n=n||t.name||"download",c.download=n,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?r(c):s(c.href)?e(t,n,o):r(c,c.target="_blank")):(c.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(c.href)}),4e4),setTimeout((function(){r(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,i){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,i),n);else if(s(t))e(t,n,i);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){r(o)}))}}:function(t,n,s,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,s);var a="application/octet-stream"===t.type,c=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&c||o)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},h.readAsDataURL(t)}else{var l=i.URL||i.webkitURL,d=l.createObjectURL(t);r?r.location=d:location.href=d,r=null,setTimeout((function(){l.revokeObjectURL(d)}),4e4)}});i.saveAs=a.saveAs=a,t.exports=a}.apply(e,[]))||(t.exports=s)},58:t=>{try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function s(t,e,s){var r,i=new Promise((function(i,o){n(r=t[e].apply(t,s)).then(i,o)}));return i.request=r,i}function r(t,e,n){var r=s(t,e,n);return r.then((function(t){if(t)return new h(t,r.request)}))}function i(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function o(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return s(this[e],r,arguments)})}))}function a(t,e,n,s){s.forEach((function(s){s in n.prototype&&(t.prototype[s]=function(){return this[e][s].apply(this[e],arguments)})}))}function c(t,e,n,s){s.forEach((function(s){s in n.prototype&&(t.prototype[s]=function(){return r(this[e],s,arguments)})}))}function u(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function d(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function f(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new d(n)}function p(t){this._db=t}i(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),i(h,"_cursor",["direction","key","primaryKey","value"]),o(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,s=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,s),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},i(l,"_store",["name","keyPath","indexNames","autoIncrement"]),o(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(l,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},i(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},i(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},i(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,u].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),s=n[n.length-1],r=this._store||this._index,i=r[t].apply(r,n.slice(0,-1));i.onsuccess=function(){s(i.result)}})}))})),[u,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,s=[];return new Promise((function(r){n.iterateCursor(t,(function(t){t?(s.push(t.value),void 0===e||s.length!=e?t.continue():r(s)):r(s)}))}))})})),t.openDb=function(t,e,n){var r=s(indexedDB,"open",[t,e]),i=r.request;return i&&(i.onupgradeneeded=function(t){n&&n(new f(i.result,t.oldVersion,i.transaction))}),r.then((function(t){return new p(t)}))},t.deleteDb=function(t){return s(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},830:(t,e)=>{e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),s=0,r=n.length;s<r;s++){var i=n[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},187:t=>{var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var s,r,i=t,o=t.indexOf("["),a=t.indexOf("]");-1!=o&&-1!=a&&(t=t.substring(0,o)+t.substring(o,a).replace(/:/g,";")+t.substring(a,t.length));for(var c,u,h=e.exec(t||""),l={},d=14;d--;)l[n[d]]=h[d]||"";return-1!=o&&-1!=a&&(l.source=i,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=(s=l.path,r=s.replace(/\/{2,9}/g,"/").split("/"),"/"!=s.substr(0,1)&&0!==s.length||r.splice(0,1),"/"==s.substr(s.length-1,1)&&r.splice(r.length-1,1),r),l.queryKey=(c=l.query,u={},c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(u[e]=n)})),u),l}},281:t=>{"use strict";var e,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},r=0,i=0;function o(t){var e="";do{e=n[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function a(){var t=o(+new Date);return t!==e?(r=0,e=t):t+"."+o(r++)}for(;i<64;i++)s[n[i]]=i;a.encode=o,a.decode=function(t){var e=0;for(i=0;i<t.length;i++)e=64*e+s[t.charAt(i)];return e},t.exports=a}},e={};function n(s){var r=e[s];if(void 0!==r)return r.exports;var i=e[s]={exports:{}};return t[s].call(i.exports,i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{Decoder:()=>Sg,Encoder:()=>kg,PacketType:()=>_g,protocol:()=>Ig});const e=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&s+1<t.length&&56320==(64512&t.charCodeAt(s+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++s)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let e=0;e<t.length;e+=3){const r=t[e],i=e+1<t.length,o=i?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=r>>2,h=(3&r)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,i||(l=64)),s.push(n[u],n[h],n[l],n[d])}return s.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((31&r)<<6|63&i)}else if(r>239&&r<365){const i=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[s++]=String.fromCharCode(55296+(i>>10)),e[s++]=String.fromCharCode(56320+(1023&i))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],i=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==i||null==o||null==a)throw Error();const c=r<<2|i>>4;if(s.push(c),64!==o){const t=i<<4&240|o>>2;if(s.push(t),64!==a){const t=o<<6&192|a;s.push(t)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},r=function(t){return function(t){const n=e(t);return s.encodeByteArray(n,!0)}(t).replace(/\./g,"")};class i{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function o(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function a(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(o())}function c(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function u(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function h(){const t=o();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}class l extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d.prototype.create)}}class d{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,r=this.errors[t],i=r?function(t,e){return t.replace(f,((t,n)=>{const s=e[n];return null!=s?String(s):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new l(s,o,n)}}const f=/\{\$([^}]+)}/g;function p(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const n=t[r],i=e[r];if(m(n)&&m(i)){if(!p(n,i))return!1}else if(n!==i)return!1}for(const t of s)if(!n.includes(t))return!1;return!0}function m(t){return null!==t&&"object"==typeof t}function g(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function y(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,s]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(s)}})),e}function v(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class w{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let s;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");s=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===s.next&&(s.next=b),void 0===s.error&&(s.error=b),void 0===s.complete&&(s.complete=b);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch(t){}})),this.observers.push(s),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function b(){}function T(t,e=1e3,n=2){const s=e*Math.pow(n,t),r=Math.round(.5*s*(Math.random()-.5)*2);return Math.min(144e5,s+r)}function E(t){return t&&t._delegate?t._delegate:t}class I{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const _="[DEFAULT]";class k{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),s=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(s)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:_})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(s);return s}onInit(t,e){var n;const s=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&t(i,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===_?void 0:s),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var s;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:_:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class S{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new k(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const A=[];var C,N;(N=C||(C={}))[N.DEBUG=0]="DEBUG",N[N.VERBOSE=1]="VERBOSE",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.SILENT=5]="SILENT";const R={debug:C.DEBUG,verbose:C.VERBOSE,info:C.INFO,warn:C.WARN,error:C.ERROR,silent:C.SILENT},L=C.INFO,D={[C.DEBUG]:"log",[C.VERBOSE]:"log",[C.INFO]:"info",[C.WARN]:"warn",[C.ERROR]:"error"},O=(t,e,...n)=>{if(e<t.logLevel)return;const s=(new Date).toISOString(),r=D[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${s}]  ${t.name}:`,...n)};class P{constructor(t){this.name=t,this._logLevel=L,this._logHandler=O,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in C))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?R[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,C.DEBUG,...t),this._logHandler(this,C.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,C.VERBOSE,...t),this._logHandler(this,C.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,C.INFO,...t),this._logHandler(this,C.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,C.WARN,...t),this._logHandler(this,C.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,C.ERROR,...t),this._logHandler(this,C.ERROR,...t)}}class x{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const M="@firebase/app",U="0.7.11",F=new P("@firebase/app"),V={[M]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},j=new Map,B=new Map;function q(t,e){try{t.container.addComponent(e)}catch(n){F.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $(t){const e=t.name;if(B.has(e))return F.debug(`There were multiple attempts to register component ${e}.`),!1;B.set(e,t);for(const e of j.values())q(e,t);return!0}function H(t,e){return t.container.getProvider(e)}const K=new d("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class z{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new I("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const G="9.6.1";function W(t="[DEFAULT]"){const e=j.get(t);if(!e)throw K.create("no-app",{appName:t});return e}function J(t,e,n){var s;let r=null!==(s=V[t])&&void 0!==s?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const t=[`Unable to register library "${r}" with version "${e}":`];return i&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void F.warn(t.join(" "))}$(new I(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}$(new I("platform-logger",(t=>new x(t)),"PRIVATE")),J(M,U,""),J(M,U,"esm2017"),J("fire-js",""),J("firebase","9.6.1","app");var X=n(676);const Q="@firebase/installations",Y="0.5.4",Z="w:0.5.4",tt=new d("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function et(t){return t instanceof l&&t.code.includes("request-failed")}function nt({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function st(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function rt(t,e){const n=(await e.json()).error;return tt.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function it({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function ot(t){const e=await t();return e.status>=500&&e.status<600?t():e}function at(t){return new Promise((e=>{setTimeout(e,t)}))}const ct=/^[cdef][\w-]{21}$/;function ut(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return ct.test(e)?e:""}catch(t){return""}}function ht(t){return`${t.appName}!${t.appId}`}const lt=new Map;function dt(t,e){const n=ht(t);ft(n,e),function(t,e){const n=(!pt&&"BroadcastChannel"in self&&(pt=new BroadcastChannel("[Firebase] FID Change"),pt.onmessage=t=>{ft(t.data.key,t.data.fid)}),pt);n&&n.postMessage({key:t,fid:e}),0===lt.size&&pt&&(pt.close(),pt=null)}(n,e)}function ft(t,e){const n=lt.get(t);if(n)for(const t of n)t(e)}let pt=null;const mt="firebase-installations-store";let gt=null;function yt(){return gt||(gt=(0,X.openDb)("firebase-installations-database",1,(t=>{0===t.oldVersion&&t.createObjectStore(mt)}))),gt}async function vt(t,e){const n=ht(t),s=(await yt()).transaction(mt,"readwrite"),r=s.objectStore(mt),i=await r.get(n);return await r.put(e,n),await s.complete,i&&i.fid===e.fid||dt(t,e.fid),e}async function wt(t){const e=ht(t),n=(await yt()).transaction(mt,"readwrite");await n.objectStore(mt).delete(e),await n.complete}async function bt(t,e){const n=ht(t),s=(await yt()).transaction(mt,"readwrite"),r=s.objectStore(mt),i=await r.get(n),o=e(i);return void 0===o?await r.delete(n):await r.put(o,n),await s.complete,!o||i&&i.fid===o.fid||dt(t,o.fid),o}async function Tt(t){let e;const n=await bt(t,(n=>{const s=function(t){return _t(t||{fid:ut(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(tt.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=async function(t,e){try{const n=await async function(t,{fid:e}){const n=nt(t),s=it(t),r={fid:e,authVersion:"FIS_v2",appId:t.appId,sdkVersion:Z},i={method:"POST",headers:s,body:JSON.stringify(r)},o=await ot((()=>fetch(n,i)));if(o.ok){const t=await o.json();return{fid:t.fid||e,registrationStatus:2,refreshToken:t.refreshToken,authToken:st(t.authToken)}}throw await rt("Create Installation",o)}(t,e);return vt(t,n)}catch(n){throw et(n)&&409===n.customData.serverCode?await wt(t):await vt(t,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:s}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Et(t)}:{installationEntry:e}}(t,s);return e=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Et(t){let e=await It(t);for(;1===e.registrationStatus;)await at(100),e=await It(t);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Tt(t);return n||e}return e}function It(t){return bt(t,(t=>{if(!t)throw tt.create("installation-not-found");return _t(t)}))}function _t(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function kt({appConfig:t,platformLoggerProvider:e},n){const s=function(t,{fid:e}){return`${nt(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=it(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),i=e.getImmediate({optional:!0});i&&r.append("x-firebase-client",i.getPlatformInfoString());const o={installation:{sdkVersion:Z}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await ot((()=>fetch(s,a)));if(c.ok)return st(await c.json());throw await rt("Generate Auth Token",c)}async function St(t,e=!1){let n;const s=await bt(t.appConfig,(s=>{if(!Ct(s))throw tt.create("not-registered");const r=s.authToken;if(!e&&(2===(i=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return s;var i;if(1===r.requestStatus)return n=async function(t,e){let n=await At(t.appConfig);for(;1===n.authToken.requestStatus;)await at(100),n=await At(t.appConfig);const s=n.authToken;return 0===s.requestStatus?St(t,e):s}(t,e),s;{if(!navigator.onLine)throw tt.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(s);return n=async function(t,e){try{const n=await kt(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await vt(t.appConfig,s),n}catch(n){if(!et(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await vt(t.appConfig,n)}else await wt(t.appConfig);throw n}}(t,e),e}}));return n?await n:s.authToken}function At(t){return bt(t,(t=>{if(!Ct(t))throw tt.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Ct(t){return void 0!==t&&2===t.registrationStatus}function Nt(t){return tt.create("missing-app-config-values",{valueName:t})}const Rt="installations";$(new I(Rt,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw Nt("App Configuration");if(!t.name)throw Nt("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Nt(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,platformLoggerProvider:H(e,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),$(new I("installations-internal",(t=>{const e=H(t.getProvider("app").getImmediate(),Rt).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:s}=await Tt(e.appConfig);return s?s.catch(console.error):St(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Tt(t);e&&await e}(n.appConfig),(await St(n,e)).token}(e,t)}}),"PRIVATE")),J(Q,Y),J(Q,Y,"esm2017");const Lt="analytics",Dt="https://www.googletagmanager.com/gtag/js",Ot=new P("@firebase/analytics");function Pt(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const xt=new d("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Mt=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Ut(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Ft(t,e=Mt,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw xt.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw xt.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new jt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Vt({appId:s,apiKey:r,measurementId:i},o,a,e)}async function Vt(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=Mt){const{appId:i,measurementId:o}=t;try{await function(t,e){return new Promise(((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(i),s(xt.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(s,e)}catch(t){if(o)return Ot.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:i,measurementId:o};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:Ut(s)},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(i,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw xt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(i),e}catch(e){if(!function(t){if(!(t instanceof l&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(r.deleteThrottleMetadata(i),o)return Ot.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:i,measurementId:o};throw e}const a=503===Number(e.customData.httpStatus)?T(n,r.intervalMillis,30):T(n,r.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return r.setThrottleMetadata(i,c),Ot.debug(`Calling attemptFetch again in ${a} millis`),Vt(t,c,s,r)}}class jt{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}async function Bt(t,e,n,s,r,i,o){var a;const c=Ft(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Ot.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>Ot.error(t))),e.push(c);const u=async function(){if("object"!=typeof indexedDB)return Ot.warn(xt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await new Promise(((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}catch(t){return Ot.warn(xt.create("indexeddb-unavailable",{errorInfo:t}).message),!1}return!0}().then((t=>t?s.getId():void 0)),[h,l]=await Promise.all([c,u]);(function(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Dt))return e;return null})()||function(t,e){const n=document.createElement("script");n.src=`${Dt}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(i,h.measurementId),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=l&&(d.firebase_id=l),r("config",h.measurementId,d),h.measurementId}class qt{constructor(t){this.app=t}_delete(){return delete $t[this.app.options.appId],Promise.resolve()}}let $t={},Ht=[];const Kt={};let zt,Gt,Wt="dataLayer",Jt=!1;function Xt(t,e,n){!function(){const t=[];if(c()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=xt.create("invalid-analytics-context",{errorInfo:e});Ot.warn(n.message)}}();const s=t.options.appId;if(!s)throw xt.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw xt.create("no-api-key");Ot.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=$t[s])throw xt.create("already-exists",{id:s});if(!Jt){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,s,r){let i=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(i=window.gtag),window.gtag=function(t,e,n,s){return async function(r,i,o){try{"event"===r?await async function(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const s=await Pt(n);for(const n of t){const t=s.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){i=[];break}i.push(r)}}0===i.length&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(t){Ot.error(t)}}(t,e,n,i,o):"config"===r?await async function(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const t=(await Pt(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(t){Ot.error(t)}t("config",r,i)}(t,e,n,s,i,o):t("set",i)}catch(t){Ot.error(t)}}}(i,t,e,n),{gtagCore:i,wrappedGtag:window.gtag}}($t,Ht,Kt);Gt=t,zt=e,Jt=!0}return $t[s]=Bt(t,Ht,Kt,e,zt,Wt,n),new qt(t)}const Qt="@firebase/analytics",Yt="0.7.4";$(new I(Lt,((t,{options:e})=>Xt(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),$(new I("analytics-internal",(function(t){try{const e=t.getProvider(Lt).getImmediate();return{logEvent:(t,n,s)=>function(t,e,n,s){t=E(t),async function(t,e,n,s,r){if(r&&r.global)t("event",n,s);else{const r=await e;t("event",n,Object.assign(Object.assign({},s),{send_to:r}))}}(Gt,$t[t.app.options.appId],e,n,s).catch((t=>Ot.error(t)))}(e,t,n,s)}}catch(t){throw xt.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),J(Qt,Yt),J(Qt,Yt,"esm2017");const Zt=function(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),s=n.name;if("string"!=typeof s||!s)throw K.create("bad-app-name",{appName:String(s)});const r=j.get(s);if(r){if(p(t,r.options)&&p(n,r.config))return r;throw K.create("duplicate-app",{appName:s})}const i=new S(s);for(const t of B.values())i.addComponent(t);const o=new z(t,n,i);return j.set(s,o),o}({apiKey:"AIzaSyCtAdfUZ8tR-mODZgkDRe6ZACdDdsA36kU",authDomain:"type-master-ecd50.firebaseapp.com",projectId:"type-master-ecd50",storageBucket:"type-master-ecd50.appspot.com",messagingSenderId:"310756367551",appId:"1:310756367551:web:9823810463c7c3e8e63a0a",measurementId:"MISSING_ENV_VAR".FIREBASE_MEADUREMENT_ID});function te(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]])}return n}!function(t=W()){const e=H(t=E(t),Lt);e.isInitialized()?e.getImmediate():function(t,e={}){const n=H(t,Lt);if(n.isInitialized()){const t=n.getImmediate();if(p(e,n.getOptions()))return t;throw xt.create("already-initialized")}n.initialize({options:e})}(t)}(Zt),Object.create,Object.create;const ee=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ne=new d("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),se=new P("@firebase/auth");function re(t,...e){se.logLevel<=C.ERROR&&se.error(`Auth (9.6.1): ${t}`,...e)}function ie(t,...e){throw ae(t,...e)}function oe(t,...e){return ae(t,...e)}function ae(t,...e){if("string"!=typeof t){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return ne.create(t,...e)}function ce(t,e,...n){if(!t)throw ae(e,...n)}function ue(t){const e="INTERNAL ASSERTION FAILED: "+t;throw re(e),new Error(e)}function he(t,e){t||ue(e)}const le=new Map;function de(t){he(t instanceof Function,"Expected a class definition");let e=le.get(t);return e?(he(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,le.set(t,e),e)}function fe(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function pe(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class me{constructor(t,e){this.shortDelay=t,this.longDelay=e,he(e>t,"Short delay should be less than long delay!"),this.isMobile=a()||u()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===pe()||"https:"===pe()||c()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ge(t,e){he(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class ye{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ue("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ue("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ue("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ve={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},we=new me(3e4,6e4);function be(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Te(t,e,n,s,r={}){return Ee(t,r,(async()=>{let r={},i={};s&&("GET"===e?i=s:r={body:JSON.stringify(s)});const o=g(Object.assign({key:t.config.apiKey},i)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),ye.fetch()(_e(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Ee(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},ve),e);try{const e=new ke(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const i=await r.json();if("needConfirmation"in i)throw Se(t,"account-exists-with-different-credential",i);if(r.ok&&!("errorMessage"in i))return i;{const e=r.ok?i.errorMessage:i.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Se(t,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw Se(t,"email-already-in-use",i);const a=s[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const s=Object.assign(Object.assign({},ee()),{[e]:n});return new d("auth","Firebase",s).create(e,{appName:t.name})}(t,a,o);ie(t,a)}}catch(e){if(e instanceof l)throw e;ie(t,"network-request-failed")}}async function Ie(t,e,n,s,r={}){const i=await Te(t,e,n,s,r);return"mfaPendingCredential"in i&&ie(t,"multi-factor-auth-required",{_serverResponse:i}),i}function _e(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?ge(t.config,r):`${t.config.apiScheme}://${r}`}class ke{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(oe(this.auth,"timeout"))),we.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Se(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=oe(t,e,s);return r.customData._tokenResponse=n,r}function Ae(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function Ce(t){return 1e3*Number(t)}function Ne(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return re("JWT malformed, contained fewer than 3 sections"),null;try{const t=function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(n);return t?JSON.parse(t):(re("Failed to decode base64 JWT payload"),null)}catch(t){return re("Caught error parsing JWT payload as JSON",t),null}}async function Re(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof l&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Le{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class De{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ae(this.lastLoginAt),this.creationTime=Ae(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oe(t){var e;const n=t.auth,s=await t.getIdToken(),r=await Re(t,async function(t,e){return Te(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:s}));ce(null==r?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=(null===(e=i.providerUserInfo)||void 0===e?void 0:e.length)?i.providerUserInfo.map((t=>{var{providerId:e}=t,n=te(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,u=o,[...c.filter((t=>!u.some((e=>e.providerId===t.providerId)))),...u]);var c,u;const h=t.isAnonymous,l=!(t.email&&i.passwordHash||(null==a?void 0:a.length)),d=!!h&&l,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new De(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class Pe{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ce(t.idToken,"internal-error"),ce(void 0!==t.idToken,"internal-error"),ce(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Ne(t);return ce(e,"internal-error"),ce(void 0!==e.exp,"internal-error"),ce(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return ce(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:s,expiresIn:r}=await async function(t,e){const n=await Ee(t,{},(async()=>{const n=g({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=t.config,i=_e(t,s,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",ye.fetch()(i,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:s,expirationTime:r}=e,i=new Pe;return n&&(ce("string"==typeof n,"internal-error",{appName:t}),i.refreshToken=n),s&&(ce("string"==typeof s,"internal-error",{appName:t}),i.accessToken=s),r&&(ce("number"==typeof r,"internal-error",{appName:t}),i.expirationTime=r),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Pe,this.toJSON())}_performRefresh(){return ue("not implemented")}}function xe(t,e){ce("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Me{constructor(t){var{uid:e,auth:n,stsTokenManager:s}=t,r=te(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Le(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.metadata=new De(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Re(this,this.stsTokenManager.getToken(this.auth,t));return ce(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=E(t),s=await n.getIdToken(e),r=Ne(s);ce(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i="object"==typeof r.firebase?r.firebase:void 0,o=null==i?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Ae(Ce(r.auth_time)),issuedAtTime:Ae(Ce(r.iat)),expirationTime:Ae(Ce(r.exp)),signInProvider:o||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=E(t);await Oe(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(ce(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new Me(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Oe(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Re(this,async function(t,e){return Te(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,s,r,i,o,a,c,u;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(s=e.email)&&void 0!==s?s:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(i=e.photoURL)&&void 0!==i?i:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:T,stsTokenManager:E}=e;ce(v&&E,t,"internal-error");const I=Pe.fromJSON(this.name,E);ce("string"==typeof v,t,"internal-error"),xe(h,t.name),xe(l,t.name),ce("boolean"==typeof w,t,"internal-error"),ce("boolean"==typeof b,t,"internal-error"),xe(d,t.name),xe(f,t.name),xe(p,t.name),xe(m,t.name),xe(g,t.name),xe(y,t.name);const _=new Me({uid:v,auth:t,email:l,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return T&&Array.isArray(T)&&(_.providerData=T.map((t=>Object.assign({},t)))),m&&(_._redirectEventId=m),_}static async _fromIdTokenResponse(t,e,n=!1){const s=new Pe;s.updateFromServerResponse(e);const r=new Me({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await Oe(r),r}}class Ue{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Ue.type="NONE";const Fe=Ue;function Ve(t,e,n){return`firebase:${t}:${e}:${n}`}class je{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=Ve(this.userKey,s.apiKey,r),this.fullPersistenceKey=Ve("persistence",s.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Me._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new je(de(Fe),t,n);const s=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=s[0]||de(Fe);const i=Ve(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(i);if(e){const s=Me._fromJSON(t,e);n!==r&&(o=s),r=n;break}}catch(t){}const a=s.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(i,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(i)}catch(t){}}))),new je(r,t,n)):new je(r,t,n)}}function Be(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ke(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qe(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ge(e))return"Blackberry";if(We(e))return"Webos";if($e(e))return"Safari";if((e.includes("chrome/")||He(e))&&!e.includes("edge/"))return"Chrome";if(ze(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function qe(t=o()){return/firefox\//i.test(t)}function $e(t=o()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function He(t=o()){return/crios\//i.test(t)}function Ke(t=o()){return/iemobile/i.test(t)}function ze(t=o()){return/android/i.test(t)}function Ge(t=o()){return/blackberry/i.test(t)}function We(t=o()){return/webos/i.test(t)}function Je(t=o()){return/iphone|ipad|ipod/i.test(t)}function Xe(t=o()){return Je(t)||ze(t)||We(t)||Ge(t)||/windows phone/i.test(t)||Ke(t)}function Qe(t,e=[]){let n;switch(t){case"Browser":n=Be(o());break;case"Worker":n=`${Be(o())}-${t}`;break;default:n=t}return`${n}/JsCore/9.6.1/${e.length?e.join(","):"FirebaseCore-web"}`}class Ye{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tn(this),this.idTokenSubscription=new tn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ne,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=de(e)),this._initializationPromise=this.queue((async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await je.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==n?void 0:n._redirectEventId,i=await this.tryRedirectSignIn(t);s&&s!==r||!(null==i?void 0:i.user)||(n=i.user)}return n?n._redirectEventId?(ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Oe(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?E(t):null;return e&&ce(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&ce(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(de(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new d("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&de(t)||this._popupRedirectResolver;ce(e,this,"argument-error"),this.redirectPersistenceManager=await je.create(this,[de(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,s){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),i=this._isInitialized?Promise.resolve():this._initializationPromise;return ce(i,this,"internal-error"),i.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,s):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Qe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId),t}}function Ze(t){return E(t)}class tn{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new w(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function en(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nn(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class sn{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return ue("not implemented")}_getIdTokenResponse(t){return ue("not implemented")}_linkToIdToken(t,e){return ue("not implemented")}_getReauthenticationResolver(t){return ue("not implemented")}}class rn extends sn{constructor(t,e,n,s=null){super("password",n),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new rn(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new rn(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return Ie(t,"POST","/v1/accounts:signInWithPassword",be(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Ie(t,"POST","/v1/accounts:signInWithEmailLink",be(t,e))}(t,{email:this._email,oobCode:this._password});default:ie(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return Te(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Ie(t,"POST","/v1/accounts:signInWithEmailLink",be(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:ie(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function on(t,e){return Ie(t,"POST","/v1/accounts:signInWithIdp",be(t,e))}class an extends sn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new an(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):ie("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:s}=e,r=te(e,["providerId","signInMethod"]);if(!n||!s)return null;const i=new an(n,s);return i.idToken=r.idToken||void 0,i.accessToken=r.accessToken||void 0,i.secret=r.secret,i.nonce=r.nonce,i.pendingToken=r.pendingToken||null,i}_getIdTokenResponse(t){return on(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,on(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,on(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=g(e)}return t}}const cn={USER_NOT_FOUND:"user-not-found"};class un extends sn{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new un({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new un({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Ie(t,"POST","/v1/accounts:signInWithPhoneNumber",be(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Ie(t,"POST","/v1/accounts:signInWithPhoneNumber",be(t,e));if(n.temporaryProof)throw Se(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Ie(t,"POST","/v1/accounts:signInWithPhoneNumber",be(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),cn)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:s}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:s}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:s,temporaryProof:r}=t;return n||e||s||r?new un({verificationId:e,verificationCode:n,phoneNumber:s,temporaryProof:r}):null}}class hn{constructor(t){var e,n,s,r,i,o;const a=y(v(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=a.mode)&&void 0!==s?s:null);ce(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(i=a.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=y(v(t)).link,n=e?y(v(e)).deep_link_id:null,s=y(v(t)).deep_link_id;return(s?y(v(s)).link:null)||s||n||e||t}(t);try{return new hn(e)}catch(t){return null}}}class ln{constructor(){this.providerId=ln.PROVIDER_ID}static credential(t,e){return rn._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=hn.parseLink(e);return ce(n,"argument-error"),rn._fromEmailAndCode(t,n.code,n.tenantId)}}ln.PROVIDER_ID="password",ln.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ln.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class dn{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class fn extends dn{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class pn extends fn{constructor(){super("facebook.com")}static credential(t){return an._fromParams({providerId:pn.PROVIDER_ID,signInMethod:pn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return pn.credentialFromTaggedObject(t)}static credentialFromError(t){return pn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return pn.credential(t.oauthAccessToken)}catch(t){return null}}}pn.FACEBOOK_SIGN_IN_METHOD="facebook.com",pn.PROVIDER_ID="facebook.com";class mn extends fn{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return an._fromParams({providerId:mn.PROVIDER_ID,signInMethod:mn.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return mn.credentialFromTaggedObject(t)}static credentialFromError(t){return mn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return mn.credential(e,n)}catch(t){return null}}}mn.GOOGLE_SIGN_IN_METHOD="google.com",mn.PROVIDER_ID="google.com";class gn extends fn{constructor(){super("github.com")}static credential(t){return an._fromParams({providerId:gn.PROVIDER_ID,signInMethod:gn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return gn.credentialFromTaggedObject(t)}static credentialFromError(t){return gn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return gn.credential(t.oauthAccessToken)}catch(t){return null}}}gn.GITHUB_SIGN_IN_METHOD="github.com",gn.PROVIDER_ID="github.com";class yn extends fn{constructor(){super("twitter.com")}static credential(t,e){return an._fromParams({providerId:yn.PROVIDER_ID,signInMethod:yn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return yn.credentialFromTaggedObject(t)}static credentialFromError(t){return yn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return yn.credential(e,n)}catch(t){return null}}}yn.TWITTER_SIGN_IN_METHOD="twitter.com",yn.PROVIDER_ID="twitter.com";class vn{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,s=!1){const r=await Me._fromIdTokenResponse(t,n,s),i=wn(n);return new vn({user:r,providerId:i,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const s=wn(n);return new vn({user:t,providerId:s,_tokenResponse:n,operationType:e})}}function wn(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class bn extends l{constructor(t,e,n,s){var r;super(e.code,e.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,bn.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,s){return new bn(t,e,n,s)}}function Tn(t,e,n,s){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw bn._fromErrorAndOperation(t,n,e,s);throw n}))}async function En(t,e,n=!1){const s="signIn",r=await Tn(t,s,e),i=await vn._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function In(t,{displayName:e,photoURL:n}){if(void 0===e&&void 0===n)return;const s=E(t),r={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},i=await Re(s,async function(t,e){return Te(t,"POST","/v1/accounts:update",e)}(s.auth,r));s.displayName=i.displayName||null,s.photoURL=i.photoUrl||null;const o=s.providerData.find((({providerId:t})=>"password"===t));o&&(o.displayName=s.displayName,o.photoURL=s.photoURL),await s._updateTokensIfNecessary(i)}new WeakMap;const _n="__sak";class kn{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(_n,"1"),this.storage.removeItem(_n),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Sn extends kn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=o();return $e(t)||Je(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Xe(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),s=this.localCache[e];n!==s&&t(e,s,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const s=this.storage.getItem(n);if(t.newValue!==s)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const s=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);h()&&10===document.documentMode&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,10):s()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Sn.type="LOCAL";const An=Sn;class Cn extends kn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Cn.type="SESSION";const Nn=Cn;class Rn{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Rn(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:s,data:r}=e.data,i=this.handlersMap[s];if(!(null==i?void 0:i.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ln(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Rn.receivers=[];class Dn{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,i;return new Promise(((o,a)=>{const c=Ln("",20);s.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);i={messageChannel:s,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[s.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function On(){return window}function Pn(){return void 0!==On().WorkerGlobalScope&&"function"==typeof On().importScripts}const xn="firebaseLocalStorageDb",Mn="firebaseLocalStorage",Un="fbase_key";class Fn{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Vn(t,e){return t.transaction([Mn],e?"readwrite":"readonly").objectStore(Mn)}function jn(){const t=indexedDB.open(xn,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Mn,{keyPath:Un})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Mn)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(xn);return new Fn(t).toPromise()}(),e(await jn()))}))}))}async function Bn(t,e,n){const s=Vn(t,!0).put({[Un]:e,value:n});return new Fn(s).toPromise()}function qn(t,e){const n=Vn(t,!0).delete(e);return new Fn(n).toPromise()}class $n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await jn()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Rn._getInstance(Pn()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Dn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await jn();return await Bn(t,_n,"1"),await qn(t,_n),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Bn(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Vn(t,!1).get(e),s=await new Fn(n).toPromise();return void 0===s?null:s.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>qn(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Vn(t,!1).getAll();return new Fn(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:s,value:r}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),e.push(s));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}$n.type="LOCAL";const Hn=$n;function Kn(t){return`__${t}${Math.floor(1e6*Math.random())}`}Kn("rcb"),new me(3e4,6e4);class zn{constructor(t){this.providerId=zn.PROVIDER_ID,this.auth=Ze(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var s;const r=await n.verify();try{let i;if(ce("string"==typeof r,t,"argument-error"),ce("recaptcha"===n.type,t,"argument-error"),i="string"==typeof e?{phoneNumber:e}:e,"session"in i){const e=i.session;if("phoneNumber"in i){ce("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Te(t,"POST","/v2/accounts/mfaEnrollment:start",be(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{ce("signin"===e.type,t,"internal-error");const n=(null===(s=i.multiFactorHint)||void 0===s?void 0:s.uid)||i.multiFactorUid;ce(n,t,"missing-multi-factor-info");const o=await function(t,e){return Te(t,"POST","/v2/accounts/mfaSignIn:start",be(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Te(t,"POST","/v1/accounts:sendVerificationCode",be(t,e))}(t,{phoneNumber:i.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,E(e))}static credential(t,e){return un._fromVerification(t,e)}static credentialFromResult(t){const e=t;return zn.credentialFromTaggedObject(e)}static credentialFromError(t){return zn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?un._fromTokenResponse(e,n):null}}zn.PROVIDER_ID="phone",zn.PHONE_SIGN_IN_METHOD="phone";class Gn extends sn{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return on(t,this._buildIdpRequest())}_linkToIdToken(t,e){return on(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return on(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Wn(t){return En(t.auth,new Gn(t),t.bypassAuthState)}function Jn(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),async function(t,e,n=!1){const{auth:s}=t,r="reauthenticate";try{const i=await Re(t,Tn(s,r,e,t),n);ce(i.idToken,s,"internal-error");const o=Ne(i.idToken);ce(o,s,"internal-error");const{sub:a}=o;return ce(t.uid===a,s,"user-mismatch"),vn._forOperation(t,r,i)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&ie(s,"user-mismatch"),t}}(n,new Gn(t),t.bypassAuthState)}async function Xn(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),async function(t,e,n=!1){const s=await Re(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return vn._forOperation(t,"link",s)}(n,new Gn(t),t.bypassAuthState)}class Qn{constructor(t,e,n,s,r=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:s,tenantId:r,error:i,type:o}=t;if(i)return void this.reject(i);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Wn;case"linkViaPopup":case"linkViaRedirect":return Xn;case"reauthViaPopup":case"reauthViaRedirect":return Jn;default:ie(this.auth,"internal-error")}}resolve(t){he(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){he(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Yn=new me(2e3,1e4);class Zn extends Qn{constructor(t,e,n,s,r){super(t,e,s,r),this.provider=n,this.authWindow=null,this.pollId=null,Zn.currentPopupAction&&Zn.currentPopupAction.cancel(),Zn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ce(t,this.auth,"internal-error"),t}async onExecution(){he(1===this.filter.length,"Popup operations only handle one event");const t=Ln();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(oe(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(oe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zn.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(oe(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Yn.get())};t()}}Zn.currentPopupAction=null;const ts=new Map;class es extends Qn{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=ts.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Ve("pendingRedirect",t.config.apiKey,t.name)}(e),s=function(t){return de(t._redirectPersistence)}(t);if(!await s._isAvailable())return!1;const r="true"===await s._get(n);return await s._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}ts.set(this.auth._key(),t)}return this.bypassAuthState||ts.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ns(t,e,n=!1){const s=Ze(t),r=function(t,e){return e?de(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(s,e),i=new es(s,r,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}class ss{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return is(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!is(t)){const s=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(oe(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rs(t))}saveEventToCache(t){this.cachedEventUids.add(rs(t)),this.lastProcessedEventTime=Date.now()}}function rs(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function is({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const os=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,as=/^https?/;function cs(t){const e=fe(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===s?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===s}if(!as.test(n))return!1;if(os.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}const us=new me(3e4,6e4);function hs(){const t=On().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let ls=null;function ds(t){return ls=ls||function(t){return new Promise(((e,n)=>{var s,r,i,o;function a(){hs(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hs(),n(oe(t,"network-request-failed"))},timeout:us.get()})}if(null===(r=null===(s=On().gapi)||void 0===s?void 0:s.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(i=On().gapi)||void 0===i?void 0:i.load)){const e=Kn("iframefcb");return On()[e]=()=>{gapi.load?a():n(oe(t,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=oe("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))).catch((t=>n(t)))}a()}})).catch((t=>{throw ls=null,t}))}(t),ls}const fs=new me(5e3,15e3),ps={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ms=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gs(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ge(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,s={apiKey:e.apiKey,appName:t.name,v:G},r=ms.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${g(s).slice(1)}`}const ys={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vs{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function ws(t,e,n,s,r,i){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:G,eventId:r};if(e instanceof dn){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(i||{}))o[t]=e}if(e instanceof fn){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?ge(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${g(a).slice(1)}`}const bs="webStorageSupport",Ts=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Nn,this._completeRedirectFn=ns}async _openPopup(t,e,n,s){var r;return he(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,s=500,r=600){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let c="";const u=Object.assign(Object.assign({},ys),{width:s.toString(),height:r.toString(),top:i,left:a}),h=o().toLowerCase();n&&(c=He(h)?"_blank":n),qe(h)&&(e=e||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=o()){var e;return Je(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}(e||"",c),new vs(null);const d=window.open(e||"",c,l);ce(d,t,"popup-blocked");try{d.focus()}catch(t){}return new vs(d)}(t,ws(t,e,n,fe(),s),Ln())}async _openRedirect(t,e,n,s){return await this._originValidation(t),r=ws(t,e,n,fe(),s),On().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(he(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await ds(t),n=On().gapi;return ce(n,t,"internal-error"),e.open({where:document.body,url:gs(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ps,dontclear:!0},(e=>new Promise((async(n,s)=>{await e.restyle({setHideOnLeave:!1});const r=oe(t,"network-request-failed"),i=On().setTimeout((()=>{s(r)}),fs.get());function o(){On().clearTimeout(i),n(e)}e.ping(o).then(o,(()=>{s(r)}))}))))}(t),n=new ss(t);return e.register("authEvent",(e=>(ce(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(bs,{type:bs},(n=>{var s;const r=null===(s=null==n?void 0:n[0])||void 0===s?void 0:s.webStorageSupport;void 0!==r&&e(!!r),ie(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Te(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(cs(t))return}catch(t){}ie(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Xe()||$e()||Je()}};var Es,Is="@firebase/auth",_s="0.19.4";class ks{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ss(t=W()){const e=H(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=H(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(p(n.getOptions(),null!=e?e:{}))return t;ie(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Ts,persistence:[Hn,An,Nn]})}Es="Browser",$(new I("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:s,authDomain:r}=n.options;return(t=>{ce(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),ce(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const n={apiKey:s,authDomain:r,clientPlatform:Es,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qe(Es)},i=new Ye(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(de);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,null==e?void 0:e.popupRedirectResolver)}(i,e),i})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),$(new I("auth-internal",(t=>(t=>new ks(t))(Ze(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),J(Is,_s,void 0),J(Is,_s,"esm2017");var As,Cs="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Ns={},Rs=Rs||{},Ls=Cs||self;function Ds(){}function Os(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ps(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var xs="closure_uid_"+(1e9*Math.random()>>>0),Ms=0;function Us(t,e,n){return t.call.apply(t.bind,arguments)}function Fs(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Vs(t,e,n){return(Vs=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Us:Fs).apply(null,arguments)}function js(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Bs(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,s){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return e.prototype[n].apply(t,r)}}function qs(){this.s=this.s,this.o=this.o}var $s={};qs.prototype.s=!1,qs.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,xs)&&t[xs]||(t[xs]=++Ms)}(this);delete $s[t]}},qs.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Hs=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ks=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,r="string"==typeof t?t.split(""):t;for(let i=0;i<s;i++)i in r&&e.call(n,r[i],i,t)};function zs(t){return Array.prototype.concat.apply([],arguments)}function Gs(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function Ws(t){return/^[\s\xa0]*$/.test(t)}var Js,Xs=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Qs(t,e){return-1!=t.indexOf(e)}function Ys(t,e){return t<e?-1:t>e?1:0}t:{var Zs=Ls.navigator;if(Zs){var tr=Zs.userAgent;if(tr){Js=tr;break t}}Js=""}function er(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function nr(t){const e={};for(const n in t)e[n]=t[n];return e}var sr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rr(t,e){let n,s;for(let e=1;e<arguments.length;e++){for(n in s=arguments[e],s)t[n]=s[n];for(let e=0;e<sr.length;e++)n=sr[e],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function ir(t){return ir[" "](t),t}ir[" "]=Ds;var or,ar,cr=Qs(Js,"Opera"),ur=Qs(Js,"Trident")||Qs(Js,"MSIE"),hr=Qs(Js,"Edge"),lr=hr||ur,dr=Qs(Js,"Gecko")&&!(Qs(Js.toLowerCase(),"webkit")&&!Qs(Js,"Edge"))&&!(Qs(Js,"Trident")||Qs(Js,"MSIE"))&&!Qs(Js,"Edge"),fr=Qs(Js.toLowerCase(),"webkit")&&!Qs(Js,"Edge");function pr(){var t=Ls.document;return t?t.documentMode:void 0}t:{var mr="",gr=(ar=Js,dr?/rv:([^\);]+)(\)|;)/.exec(ar):hr?/Edge\/([\d\.]+)/.exec(ar):ur?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ar):fr?/WebKit\/(\S+)/.exec(ar):cr?/(?:Version)[ \/]?(\S+)/.exec(ar):void 0);if(gr&&(mr=gr?gr[1]:""),ur){var yr=pr();if(null!=yr&&yr>parseFloat(mr)){or=String(yr);break t}}or=mr}var vr,wr={};function br(){return t=wr,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=Xs(String(or)).split("."),n=Xs("9").split("."),s=Math.max(e.length,n.length);for(let o=0;0==t&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==r[0].length&&0==i[0].length)break;t=Ys(0==r[1].length?0:parseInt(r[1],10),0==i[1].length?0:parseInt(i[1],10))||Ys(0==r[2].length,0==i[2].length)||Ys(r[2],i[2]),r=r[3],i=i[3]}while(0==t)}return 0<=t}();var t}Ls.document&&ur?vr=pr()||parseInt(or,10)||void 0:vr=void 0;var Tr=vr,Er=function(){if(!Ls.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ls.addEventListener("test",Ds,e),Ls.removeEventListener("test",Ds,e)}catch(t){}return t}();function Ir(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function _r(t,e){if(Ir.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(dr){t:{try{ir(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:kr[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_r.Z.h.call(this)}}Ir.prototype.h=function(){this.defaultPrevented=!0},Bs(_r,Ir);var kr={2:"touch",3:"pen",4:"mouse"};_r.prototype.h=function(){_r.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Sr="closure_listenable_"+(1e6*Math.random()|0),Ar=0;function Cr(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=r,this.key=++Ar,this.ca=this.fa=!1}function Nr(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Rr(t){this.src=t,this.g={},this.h=0}function Lr(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=Hs(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Nr(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Dr(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==s)return r}return-1}Rr.prototype.add=function(t,e,n,s,r){var i=t.toString();(t=this.g[i])||(t=this.g[i]=[],this.h++);var o=Dr(t,e,s,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new Cr(e,this.src,i,!!s,r)).fa=n,t.push(e)),e};var Or="closure_lm_"+(1e6*Math.random()|0),Pr={};function xr(t,e,n,s,r){if(s&&s.once)return Ur(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)xr(t,e[i],n,s,r);return null}return n=Hr(n),t&&t[Sr]?t.N(e,n,Ps(s)?!!s.capture:!!s,r):Mr(t,e,n,!1,s,r)}function Mr(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=Ps(r)?!!r.capture:!!r,a=qr(t);if(a||(t[Or]=a=new Rr(t)),(n=a.add(e,n,s,o,i)).proxy)return n;if(s=function(){var t=Br;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)Er||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(jr(e.toString()),s);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(s)}return n}function Ur(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Ur(t,e[i],n,s,r);return null}return n=Hr(n),t&&t[Sr]?t.O(e,n,Ps(s)?!!s.capture:!!s,r):Mr(t,e,n,!0,s,r)}function Fr(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)Fr(t,e[i],n,s,r);else s=Ps(s)?!!s.capture:!!s,n=Hr(n),t&&t[Sr]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Dr(i=t.g[e],n,s,r))&&(Nr(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete t.g[e],t.h--))):t&&(t=qr(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Dr(e,n,s,r)),(n=-1<t?e[t]:null)&&Vr(n))}function Vr(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Sr])Lr(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(jr(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=qr(e))?(Lr(n,t),0==n.h&&(n.src=null,e[Or]=null)):Nr(t)}}}function jr(t){return t in Pr?Pr[t]:Pr[t]="on"+t}function Br(t,e){if(t.ca)t=!0;else{e=new _r(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&Vr(t),t=n.call(s,e)}return t}function qr(t){return(t=t[Or])instanceof Rr?t:null}var $r="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hr(t){return"function"==typeof t?t:(t[$r]||(t[$r]=function(e){return t.handleEvent(e)}),t[$r])}function Kr(){qs.call(this),this.i=new Rr(this),this.P=this,this.I=null}function zr(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,"string"==typeof e)e=new Ir(e,t);else if(e instanceof Ir)e.target=e.target||t;else{var r=e;rr(e=new Ir(s,t),r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=Gr(o,s,!0,e)&&r}if(r=Gr(o=e.g=t,s,!0,e)&&r,r=Gr(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)r=Gr(o=e.g=n[i],s,!1,e)&&r}function Gr(t,e,n,s){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Lr(t.i,o),r=!1!==a.call(c,s)&&r}}return r&&!s.defaultPrevented}Bs(Kr,qs),Kr.prototype[Sr]=!0,Kr.prototype.removeEventListener=function(t,e,n,s){Fr(this,t,e,n,s)},Kr.prototype.M=function(){if(Kr.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],s=0;s<n.length;s++)Nr(n[s]);delete e.g[t],e.h--}}this.I=null},Kr.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)},Kr.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};var Wr=Ls.JSON.stringify;function Jr(){var t=ni;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Xr,Qr=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Yr),(t=>t.reset()));class Yr{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Zr(t){Ls.setTimeout((()=>{throw t}),0)}function ti(t,e){Xr||function(){var t=Ls.Promise.resolve(void 0);Xr=function(){t.then(si)}}(),ei||(Xr(),ei=!0),ni.add(t,e)}var ei=!1,ni=new class{constructor(){this.h=this.g=null}add(t,e){const n=Qr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function si(){for(var t;t=Jr();){try{t.h.call(t.g)}catch(t){Zr(t)}var e=Qr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ei=!1}function ri(t,e){Kr.call(this),this.h=t||1,this.g=e||Ls,this.j=Vs(this.kb,this),this.l=Date.now()}function ii(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function oi(t,e,n){if("function"==typeof t)n&&(t=Vs(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Vs(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ls.setTimeout(t,e||0)}function ai(t){t.g=oi((()=>{t.g=null,t.i&&(t.i=!1,ai(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Bs(ri,Kr),(As=ri.prototype).da=!1,As.S=null,As.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),zr(this,"tick"),this.da&&(ii(this),this.start()))}},As.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},As.M=function(){ri.Z.M.call(this),ii(this),delete this.g};class ci extends qs{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:ai(this)}M(){super.M(),this.g&&(Ls.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ui(t){qs.call(this),this.h=t,this.g={}}Bs(ui,qs);var hi=[];function li(t,e,n,s){Array.isArray(n)||(n&&(hi[0]=n.toString()),n=hi);for(var r=0;r<n.length;r++){var i=xr(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function di(t){er(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Vr(t)}),t),t.g={}}function fi(){this.g=!0}function pi(t,e,n,s){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<r.length;o++)r[o]=""}}}return Wr(n)}catch(t){return e}}(t,n)+(s?" "+s:"")}))}ui.prototype.M=function(){ui.Z.M.call(this),di(this)},ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fi.prototype.Aa=function(){this.g=!1},fi.prototype.info=function(){};var mi={},gi=null;function yi(){return gi=gi||new Kr}function vi(t){Ir.call(this,mi.Ma,t)}function wi(t){const e=yi();zr(e,new vi(e,t))}function bi(t,e){Ir.call(this,mi.STAT_EVENT,t),this.stat=e}function Ti(t){const e=yi();zr(e,new bi(e,t))}function Ei(t,e){Ir.call(this,mi.Na,t),this.size=e}function Ii(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ls.setTimeout((function(){t()}),e)}mi.Ma="serverreachability",Bs(vi,Ir),mi.STAT_EVENT="statevent",Bs(bi,Ir),mi.Na="timingevent",Bs(Ei,Ir);var _i={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ki={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Si(){}function Ai(t){return t.h||(t.h=t.i())}function Ci(){}Si.prototype.h=null;var Ni,Ri={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Li(){Ir.call(this,"d")}function Di(){Ir.call(this,"c")}function Oi(){}function Pi(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new ui(this),this.P=Mi,t=lr?125:void 0,this.W=new ri(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new xi}function xi(){this.i=null,this.g="",this.h=!1}Bs(Li,Ir),Bs(Di,Ir),Bs(Oi,Si),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},Ni=new Oi;var Mi=45e3,Ui={},Fi={};function Vi(t,e,n){t.K=1,t.v=co(no(e)),t.s=n,t.U=!0,ji(t,null)}function ji(t,e){t.F=Date.now(),Hi(t),t.A=no(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),Eo(n.h,"t",s),t.C=0,n=t.l.H,t.h=new xi,t.g=Ea(t.l,n?e:null,!t.s),0<t.O&&(t.L=new ci(Vs(t.Ia,t,t.g),t.O)),li(t.V,t.g,"readystatechange",t.gb),e=t.H?nr(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),wi(1),function(t,e,n,s,r,i){t.info((function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Bi(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function qi(t,e,n){let s,r=!0;for(;!t.I&&t.C<n.length;){if(s=$i(t,n),s==Fi){4==e&&(t.o=4,Ti(14),r=!1),pi(t.j,t.m,null,"[Incomplete Response]");break}if(s==Ui){t.o=4,Ti(15),pi(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}pi(t.j,t.m,s,null),Ji(t,s)}Bi(t)&&s!=Fi&&s!=Ui&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ti(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),pa(e),e.L=!0,Ti(11))):(pi(t.j,t.m,n,"[Invalid Chunked Response]"),Wi(t),Gi(t))}function $i(t,e){var n=t.C,s=e.indexOf("\n",n);return-1==s?Fi:(n=Number(e.substring(n,s)),isNaN(n)?Ui:(s+=1)+n>e.length?Fi:(e=e.substr(s,n),t.C=s+n,e))}function Hi(t){t.Y=Date.now()+t.P,Ki(t,t.P)}function Ki(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ii(Vs(t.eb,t),e)}function zi(t){t.B&&(Ls.clearTimeout(t.B),t.B=null)}function Gi(t){0==t.l.G||t.I||ya(t.l,t)}function Wi(t){zi(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,ii(t.W),di(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ji(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Co(n.i,t)))if(n.I=t.N,!t.J&&Co(n.i,t)&&3==n.G){try{var s=n.Ca.g.parse(e)}catch(t){s=null}if(Array.isArray(s)&&3==s.length){var r=s;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;ga(n),ia(n)}fa(n),Ti(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ii(Vs(n.ab,n),6e3));if(1>=Ao(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else wa(n,11)}else if((t.J||n.g==t)&&ga(n),!Ws(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const e=u[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const r=u[4];null!=r&&(n.za=r,n.h.info("SVER="+n.za));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(s=1.5*h,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var i=s.i;!i.g&&(Qs(t,"spdy")||Qs(t,"quic")||Qs(t,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(No(i,i.h),i.h=null))}if(s.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(s.sa=t,ao(s.F,s.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((s=n).oa=Ta(s,s.H?s.la:null,s.W),o.J){Ro(s.i,o);var a=o,c=s.K;c&&a.setTimeout(c),a.B&&(zi(a),Hi(a)),s.g=o}else da(s);0<n.l.length&&ca(n)}else"stop"!=u[0]&&"close"!=u[0]||wa(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?wa(n,7):ra(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}wi(4)}catch(t){}}function Xi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Os(t)||"string"==typeof t)Ks(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Os(t)||"string"==typeof t){n=[];for(var s=t.length,r=0;r<s;r++)n.push(r)}else for(r in n=[],s=0,t)n[s++]=r;s=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Os(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}for(s in e=[],n=0,t)e[n++]=t[s];return e}(t),r=s.length;for(var i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}}function Qi(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof Qi)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}function Yi(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];Zi(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)Zi(r,s=t.g[e])||(t.g[n++]=s,r[s]=1),e++;t.g.length=n}}function Zi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(As=Pi.prototype).setTimeout=function(t){this.P=t},As.gb=function(t){t=t.target;const e=this.L;e&&3==Zo(t)?e.l():this.Ia(t)},As.Ia=function(t){try{if(t==this.g)t:{const h=Zo(this.g);var e=this.g.Da();const l=this.g.ba();if(!(3>h)&&(3!=h||lr||this.g&&(this.h.h||this.g.ga()||ta(this.g)))){this.I||4!=h||7==e||wi(8==e||0>=l?3:2),zi(this);var n=this.g.ba();this.N=n;e:if(Bi(this)){var s=ta(this.g);t="";var r=s.length,i=4==Zo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Wi(this),Gi(this);var o="";break e}this.h.i=new Ls.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,s,r,i,o){t.info((function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+i+" "+o}))}(this.j,this.u,this.A,this.m,this.X,h,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ws(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,Ti(12),Wi(this),Gi(this);break t}pi(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ji(this,n)}this.U?(qi(this,h,o),lr&&this.i&&3==h&&(li(this.V,this.W,"tick",this.fb),this.W.start())):(pi(this.j,this.m,o,null),Ji(this,o)),4==h&&Wi(this),this.i&&!this.I&&(4==h?ya(this.l,this):(this.i=!1,Hi(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Ti(12)):(this.o=0,Ti(13)),Wi(this),Gi(this)}}}catch(t){}},As.fb=function(){if(this.g){var t=Zo(this.g),e=this.g.ga();this.C<e.length&&(zi(this),qi(this,t,e),this.i&&4!=t&&Hi(this))}},As.cancel=function(){this.I=!0,Wi(this)},As.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(wi(3),Ti(17)),Wi(this),this.o=2,Gi(this)):Ki(this,this.Y-t)},(As=Qi.prototype).R=function(){Yi(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},As.T=function(){return Yi(this),this.g.concat()},As.get=function(t,e){return Zi(this.h,t)?this.h[t]:e},As.set=function(t,e){Zi(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},As.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var r=n[s],i=this.get(r);t.call(e,i,r,this)}};var to=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function eo(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof eo){this.g=void 0!==e?e:t.g,so(this,t.j),this.s=t.s,ro(this,t.i),io(this,t.m),this.l=t.l,e=t.h;var n=new vo;n.i=e.i,e.g&&(n.g=new Qi(e.g),n.h=e.h),oo(this,n),this.o=t.o}else t&&(n=String(t).match(to))?(this.g=!!e,so(this,n[1]||"",!0),this.s=uo(n[2]||""),ro(this,n[3]||"",!0),io(this,n[4]),this.l=uo(n[5]||"",!0),oo(this,n[6]||"",!0),this.o=uo(n[7]||"")):(this.g=!!e,this.h=new vo(null,this.g))}function no(t){return new eo(t)}function so(t,e,n){t.j=n?uo(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ro(t,e,n){t.i=n?uo(e,!0):e}function io(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function oo(t,e,n){e instanceof vo?(t.h=e,function(t,e){e&&!t.j&&(wo(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(bo(this,e),Eo(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=ho(e,go)),t.h=new vo(e,t.g))}function ao(t,e,n){t.h.set(e,n)}function co(t){return ao(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function uo(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ho(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,lo),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function lo(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}eo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ho(e,fo,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ho(e,fo,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(ho(n,"/"==n.charAt(0)?mo:po,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ho(n,yo)),t.join("")};var fo=/[#\/\?@]/g,po=/[#\?:]/g,mo=/[#\?]/g,go=/[#\?@]/g,yo=/#/g;function vo(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function wo(t){t.g||(t.g=new Qi,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function bo(t,e){wo(t),e=Io(t,e),Zi(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Zi((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Yi(t)))}function To(t,e){return wo(t),e=Io(t,e),Zi(t.g.h,e)}function Eo(t,e,n){bo(t,e),0<n.length&&(t.i=null,t.g.set(Io(t,e),Gs(n)),t.h+=n.length)}function Io(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function _o(t){this.l=t||ko,t=Ls.PerformanceNavigationTiming?0<(t=Ls.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ls.g&&Ls.g.Ea&&Ls.g.Ea()&&Ls.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(As=vo.prototype).add=function(t,e){wo(this),this.i=null,t=Io(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},As.forEach=function(t,e){wo(this),this.g.forEach((function(n,s){Ks(n,(function(n){t.call(e,n,s,this)}),this)}),this)},As.T=function(){wo(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var r=t[s],i=0;i<r.length;i++)n.push(e[s]);return n},As.R=function(t){wo(this);var e=[];if("string"==typeof t)To(this,t)&&(e=zs(e,this.g.get(Io(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=zs(e,t[n])}return e},As.set=function(t,e){return wo(this),this.i=null,To(this,t=Io(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},As.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},As.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],r=encodeURIComponent(String(s));s=this.R(s);for(var i=0;i<s.length;i++){var o=r;""!==s[i]&&(o+="="+encodeURIComponent(String(s[i]))),t.push(o)}}return this.i=t.join("&")};var ko=10;function So(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ao(t){return t.h?1:t.g?t.g.size:0}function Co(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function No(t,e){t.g?t.g.add(e):t.h=e}function Ro(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Lo(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Gs(t.i)}function Do(){}function Oo(){this.g=new Do}function Po(t,e,n){const s=n||"";try{Xi(t,(function(t,n){let r=t;Ps(t)&&(r=Wr(t)),e.push(s+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}function xo(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch(t){}}function Mo(t){this.l=t.$b||null,this.j=t.ib||!1}function Uo(t,e){Kr.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Fo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_o.prototype.cancel=function(){if(this.i=Lo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Do.prototype.stringify=function(t){return Ls.JSON.stringify(t,void 0)},Do.prototype.parse=function(t){return Ls.JSON.parse(t,void 0)},Bs(Mo,Si),Mo.prototype.g=function(){return new Uo(this.l,this.j)},Mo.prototype.i=function(t){return function(){return t}}({}),Bs(Uo,Kr);var Fo=0;function Vo(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function jo(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bo(t)}function Bo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(As=Uo.prototype).open=function(t,e){if(this.readyState!=Fo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bo(this)},As.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Ls).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},As.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jo(this)),this.readyState=Fo},As.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bo(this)),this.g&&(this.readyState=3,Bo(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Ls.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Vo(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},As.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?jo(this):Bo(this),3==this.readyState&&Vo(this)}},As.Ua=function(t){this.g&&(this.response=this.responseText=t,jo(this))},As.Ta=function(t){this.g&&(this.response=t,jo(this))},As.ha=function(){this.g&&jo(this)},As.setRequestHeader=function(t,e){this.v.append(t,e)},As.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},As.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Uo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var qo=Ls.JSON.parse;function $o(t){Kr.call(this),this.headers=new Qi,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Ho,this.K=this.L=!1}Bs($o,Kr);var Ho="",Ko=/^https?$/i,zo=["POST","PUT"];function Go(t){return"content-type"==t.toLowerCase()}function Wo(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Jo(t),Qo(t)}function Jo(t){t.D||(t.D=!0,zr(t,"complete"),zr(t,"error"))}function Xo(t){if(t.h&&void 0!==Rs&&(!t.C[1]||4!=Zo(t)||2!=t.ba()))if(t.v&&4==Zo(t))oi(t.Fa,0,t);else if(zr(t,"readystatechange"),4==Zo(t)){t.h=!1;try{const a=t.ba();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===a){var r=String(t.H).match(to)[1]||null;if(!r&&Ls.self&&Ls.self.location){var i=Ls.self.location.protocol;r=i.substr(0,i.length-1)}s=!Ko.test(r?r.toLowerCase():"")}n=s}if(n)zr(t,"complete"),zr(t,"success");else{t.m=6;try{var o=2<Zo(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.ba()+"]",Jo(t)}}finally{Qo(t)}}}function Qo(t,e){if(t.g){Yo(t);const n=t.g,s=t.C[0]?Ds:null;t.g=null,t.C=null,e||zr(t,"ready");try{n.onreadystatechange=s}catch(t){}}}function Yo(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Ls.clearTimeout(t.A),t.A=null)}function Zo(t){return t.g?t.g.readyState:0}function ta(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Ho:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ea(t,e,n){t:{for(s in n){var s=!1;break t}s=!0}s||(n=function(t){let e="";return er(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ao(t,e,n))}function na(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sa(t){this.za=0,this.l=[],this.h=new fi,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=na("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=na("baseRetryDelayMs",5e3,t),this.$a=na("retryDelaySeedMs",1e4,t),this.Ya=na("forwardChannelMaxRetries",2,t),this.ra=na("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new _o(t&&t.concurrentRequestLimit),this.Ca=new Oo,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function ra(t){if(oa(t),3==t.G){var e=t.V++,n=no(t.F);ao(n,"SID",t.J),ao(n,"RID",e),ao(n,"TYPE","terminate"),ha(t,n),(e=new Pi(t,t.h,e,void 0)).K=2,e.v=co(no(n)),n=!1,Ls.navigator&&Ls.navigator.sendBeacon&&(n=Ls.navigator.sendBeacon(e.v.toString(),"")),!n&&Ls.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ea(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Hi(e)}ba(t)}function ia(t){t.g&&(pa(t),t.g.cancel(),t.g=null)}function oa(t){ia(t),t.u&&(Ls.clearTimeout(t.u),t.u=null),ga(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ls.clearTimeout(t.m),t.m=null)}function aa(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&ca(t)}function ca(t){So(t.i)||t.m||(t.m=!0,ti(t.Ha,t),t.C=0)}function ua(t,e){var n;n=e?e.m:t.V++;const s=no(t.F);ao(s,"SID",t.J),ao(s,"RID",n),ao(s,"AID",t.U),ha(t,s),t.o&&t.s&&ea(s,t.o,t.s),n=new Pi(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=la(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),No(t.i,n),Vi(n,s,e)}function ha(t,e){t.j&&Xi({},(function(t,n){ao(e,n,t)}))}function la(t,e,n){n=Math.min(t.l.length,n);var s=t.j?Vs(t.j.Oa,t.j,t):null;t:{var r=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let i=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),i=!1;else try{Po(a,t,"req"+n+"_")}catch(t){s&&s(a)}}if(i){s=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,s}function da(t){t.g||t.u||(t.Y=1,ti(t.Ga,t),t.A=0)}function fa(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=Ii(Vs(t.Ga,t),va(t,t.A)),t.A++,0))}function pa(t){null!=t.B&&(Ls.clearTimeout(t.B),t.B=null)}function ma(t){t.g=new Pi(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=no(t.oa);ao(e,"RID","rpc"),ao(e,"SID",t.J),ao(e,"CI",t.N?"0":"1"),ao(e,"AID",t.U),ha(t,e),ao(e,"TYPE","xmlhttp"),t.o&&t.s&&ea(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=co(no(e)),n.s=null,n.U=!0,ji(n,t)}function ga(t){null!=t.v&&(Ls.clearTimeout(t.v),t.v=null)}function ya(t,e){var n=null;if(t.g==e){ga(t),pa(t),t.g=null;var s=2}else{if(!Co(t.i,e))return;n=e.D,Ro(t.i,e),s=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==s){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;zr(s=yi(),new Ei(s,n,e,r)),ca(t)}else da(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==s&&function(t,e){return!(Ao(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Ii(Vs(t.Ha,t,e),va(t,t.C)),t.C++,0)))}(t,e)||2==s&&fa(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:wa(t,5);break;case 4:wa(t,10);break;case 3:wa(t,6);break;default:wa(t,2)}}function va(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function wa(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var s=Vs(t.jb,t);n||(n=new eo("//www.google.com/images/cleardot.gif"),Ls.location&&"http"==Ls.location.protocol||so(n,"https"),co(n)),function(t,e){const n=new fi;if(Ls.Image){const s=new Image;s.onload=js(xo,n,s,"TestLoadImage: loaded",!0,e),s.onerror=js(xo,n,s,"TestLoadImage: error",!1,e),s.onabort=js(xo,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=js(xo,n,s,"TestLoadImage: timeout",!1,e),Ls.setTimeout((function(){s.ontimeout&&s.ontimeout()}),1e4),s.src=t}else e(!1)}(n.toString(),s)}else Ti(2);t.G=0,t.j&&t.j.va(e),ba(t),oa(t)}function ba(t){t.G=0,t.I=-1,t.j&&(0==Lo(t.i).length&&0==t.l.length||(t.i.i.length=0,Gs(t.l),t.l.length=0),t.j.ua())}function Ta(t,e,n){let s=function(t){return t instanceof eo?no(t):new eo(t,void 0)}(n);if(""!=s.i)e&&ro(s,e+"."+s.i),io(s,s.m);else{const t=Ls.location;s=function(t,e,n,s){var r=new eo(null,void 0);return t&&so(r,t),e&&ro(r,e),n&&io(r,n),s&&(r.l=s),r}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&er(t.aa,(function(t,e){ao(s,e,t)})),e=t.D,n=t.sa,e&&n&&ao(s,e,n),ao(s,"VER",t.ma),ha(t,s),s}function Ea(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new $o(new Mo({ib:!0})):new $o(t.qa)).L=t.H,e}function Ia(){}function _a(){if(ur&&!(10<=Number(Tr)))throw Error("Environmental error: no available transport.")}function ka(t,e){Kr.call(this),this.g=new sa(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ws(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ws(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ca(this)}function Sa(t){Li.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Aa(){Di.call(this),this.status=1}function Ca(t){this.g=t}(As=$o.prototype).ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ni.g(),this.C=this.u?Ai(this.u):Ai(Ni),this.g.onreadystatechange=Vs(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Wo(this,t)}t=n||"";const r=new Qi(this.headers);s&&Xi(s,(function(t,e){r.set(e,t)})),s=function(t){t:{var e=Go;const n=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<n;r++)if(r in s&&e.call(void 0,s[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.T()),n=Ls.FormData&&t instanceof Ls.FormData,!(0<=Hs(zo,e))||s||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yo(this),0<this.B&&((this.K=function(t){return ur&&br()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Vs(this.pa,this)):this.A=oi(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Wo(this,t)}},As.pa=function(){void 0!==Rs&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,zr(this,"timeout"),this.abort(8))},As.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,zr(this,"complete"),zr(this,"abort"),Qo(this))},As.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Qo(this,!0)),$o.Z.M.call(this)},As.Fa=function(){this.s||(this.F||this.v||this.l?Xo(this):this.cb())},As.cb=function(){Xo(this)},As.ba=function(){try{return 2<Zo(this)?this.g.status:-1}catch(t){return-1}},As.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},As.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),qo(e)}},As.Da=function(){return this.m},As.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(As=sa.prototype).ma=8,As.G=1,As.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},As.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new Pi(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=nr(i),rr(i,this.P)):i=this.P),null===this.o&&(r.H=i),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var s=this.l[n];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=la(this,r,e),ao(n=no(this.F),"RID",t),ao(n,"CVER",22),this.D&&ao(n,"X-HTTP-Session-Id",this.D),ha(this,n),this.o&&i&&ea(n,this.o,i),No(this.i,r),this.Ra&&ao(n,"TYPE","init"),this.ja?(ao(n,"$req",e),ao(n,"SID","null"),r.$=!0,Vi(r,n,null)):Vi(r,n,e),this.G=2}}else 3==this.G&&(t?ua(this,t):0==this.l.length||So(this.i)||ua(this))},As.Ga=function(){if(this.u=null,ma(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ii(Vs(this.bb,this),t)}},As.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ti(10),ia(this),ma(this))},As.ab=function(){null!=this.v&&(this.v=null,ia(this),fa(this),Ti(19))},As.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ti(2)):(this.h.info("Failed to ping google.com"),Ti(1))},(As=Ia.prototype).xa=function(){},As.wa=function(){},As.va=function(){},As.ua=function(){},As.Oa=function(){},_a.prototype.g=function(t,e){return new ka(t,e)},Bs(ka,Kr),ka.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),ti(Vs(t.hb,t,e))),Ti(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Ta(t,null,t.W),ca(t)},ka.prototype.close=function(){ra(this.g)},ka.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,aa(this.g,e)}else this.v?((e={}).__data__=Wr(t),aa(this.g,e)):aa(this.g,t)},ka.prototype.M=function(){this.g.j=null,delete this.j,ra(this.g),delete this.g,ka.Z.M.call(this)},Bs(Sa,Li),Bs(Aa,Di),Bs(Ca,Ia),Ca.prototype.xa=function(){zr(this.g,"a")},Ca.prototype.wa=function(t){zr(this.g,new Sa(t))},Ca.prototype.va=function(t){zr(this.g,new Aa(t))},Ca.prototype.ua=function(){zr(this.g,"b")},_a.prototype.createWebChannel=_a.prototype.g,ka.prototype.send=ka.prototype.u,ka.prototype.open=ka.prototype.m,ka.prototype.close=ka.prototype.close,_i.NO_ERROR=0,_i.TIMEOUT=8,_i.HTTP_ERROR=6,ki.COMPLETE="complete",Ci.EventType=Ri,Ri.OPEN="a",Ri.CLOSE="b",Ri.ERROR="c",Ri.MESSAGE="d",Kr.prototype.listen=Kr.prototype.N,$o.prototype.listenOnce=$o.prototype.O,$o.prototype.getLastError=$o.prototype.La,$o.prototype.getLastErrorCode=$o.prototype.Da,$o.prototype.getStatus=$o.prototype.ba,$o.prototype.getResponseJson=$o.prototype.Qa,$o.prototype.getResponseText=$o.prototype.ga,$o.prototype.send=$o.prototype.ea;var Na=Ns.createWebChannelTransport=function(){return new _a},Ra=Ns.getStatEventTarget=function(){return yi()},La=Ns.ErrorCode=_i,Da=Ns.EventType=ki,Oa=Ns.Event=mi,Pa=Ns.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},xa=Ns.FetchXmlHttpFactory=Mo,Ma=Ns.WebChannel=Ci,Ua=Ns.XhrIo=$o;const Fa="@firebase/firestore";class Va{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Va.UNAUTHENTICATED=new Va(null),Va.GOOGLE_CREDENTIALS=new Va("google-credentials-uid"),Va.FIRST_PARTY=new Va("first-party-uid"),Va.MOCK_USER=new Va("mock-user");let ja="9.6.1";const Ba=new P("@firebase/firestore");function qa(){return Ba.logLevel}function $a(t,...e){if(Ba.logLevel<=C.DEBUG){const n=e.map(za);Ba.debug(`Firestore (${ja}): ${t}`,...n)}}function Ha(t,...e){if(Ba.logLevel<=C.ERROR){const n=e.map(za);Ba.error(`Firestore (${ja}): ${t}`,...n)}}function Ka(t,...e){if(Ba.logLevel<=C.WARN){const n=e.map(za);Ba.warn(`Firestore (${ja}): ${t}`,...n)}}function za(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ga(t="Unexpected state"){const e=`FIRESTORE (${ja}) INTERNAL ASSERTION FAILED: `+t;throw Ha(e),new Error(e)}function Wa(t,e){t||Ga()}function Ja(t,e){return t}const Xa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qa extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ya{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Za{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class tc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Va.UNAUTHENTICATED)))}shutdown(){}}class ec{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class nc{constructor(t){this.t=t,this.currentUser=Va.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const s=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new Ya;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ya,t.enqueueRetryable((()=>s(this.currentUser)))};const i=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await s(this.currentUser)}))},o=t=>{$a("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):($a("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ya)}}),0),i()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?($a("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Wa("string"==typeof e.accessToken),new Za(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Wa(null===t||"string"==typeof t),new Va(t)}}class sc{constructor(t,e,n){this.type="FirstParty",this.user=Va.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const s=t.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class rc{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new sc(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(Va.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ic{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oc{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null}start(t,e){this.o=n=>{t.enqueueRetryable((()=>(t=>(null!=t.error&&$a("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`),e(t.token)))(n)))};const n=t=>{$a("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>n(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?n(t):$a("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Wa("string"==typeof t.token),new ic(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class ac{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.p(t),this.T=t=>e.writeSequenceNumber(t))}p(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.T&&this.T(t),t}}function cc(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}ac.I=-1;class uc{static A(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=cc(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<e&&(n+=t.charAt(s[r]%t.length))}return n}}function hc(t,e){return t<e?-1:t>e?1:0}function lc(t,e,n){return t.length===e.length&&t.every(((t,s)=>n(t,e[s])))}class dc{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Qa(Xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Qa(Xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Qa(Xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Qa(Xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return dc.fromMillis(Date.now())}static fromDate(t){return dc.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new dc(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?hc(this.nanoseconds,t.nanoseconds):hc(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fc{constructor(t){this.timestamp=t}static fromTimestamp(t){return new fc(t)}static min(){return new fc(new dc(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function pc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function mc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class yc{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ga(),void 0===n?n=t.length-e:n>t.length-e&&Ga(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===yc.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof yc?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),r=e.get(s);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class vc extends yc{construct(t,e,n){return new vc(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Qa(Xa.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new vc(e)}static emptyPath(){return new vc([])}}const wc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bc extends yc{construct(t,e,n){return new bc(t,e,n)}static isValidIdentifier(t){return wc.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bc.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bc(["__name__"])}static fromServerFormat(t){const e=[];let n="",s=0;const r=()=>{if(0===n.length)throw new Qa(Xa.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let i=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new Qa(Xa.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Qa(Xa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(i=!i,s++):"."!==e||i?(n+=e,s++):(r(),s++)}if(r(),i)throw new Qa(Xa.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bc(e)}static emptyPath(){return new bc([])}}class Tc{constructor(t){this.fields=t,t.sort(bc.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return lc(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Ec{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new Ec(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Ec(e)}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return hc(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ec.EMPTY_BYTE_STRING=new Ec("");const Ic=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _c(t){if(Wa(!!t),"string"==typeof t){let e=0;const n=Ic.exec(t);if(Wa(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:kc(t.seconds),nanos:kc(t.nanos)}}function kc(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Sc(t){return"string"==typeof t?Ec.fromBase64String(t):Ec.fromUint8Array(t)}function Ac(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Cc(t){const e=t.mapValue.fields.__previous_value__;return Ac(e)?Cc(e):e}function Nc(t){const e=_c(t.mapValue.fields.__local_write_time__.timestampValue);return new dc(e.seconds,e.nanos)}function Rc(t){return null==t}function Lc(t){return 0===t&&1/t==-1/0}class Dc{constructor(t){this.path=t}static fromPath(t){return new Dc(vc.fromString(t))}static fromName(t){return new Dc(vc.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===vc.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return vc.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Dc(new vc(t.slice()))}}function Oc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ac(t)?4:10:Ga()}function Pc(t,e){const n=Oc(t);if(n!==Oc(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nc(t).isEqual(Nc(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=_c(t.timestampValue),s=_c(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Sc(t.bytesValue).isEqual(Sc(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return kc(t.geoPointValue.latitude)===kc(e.geoPointValue.latitude)&&kc(t.geoPointValue.longitude)===kc(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return kc(t.integerValue)===kc(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=kc(t.doubleValue),s=kc(e.doubleValue);return n===s?Lc(n)===Lc(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return lc(t.arrayValue.values||[],e.arrayValue.values||[],Pc);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(pc(n)!==pc(s))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===s[t]||!Pc(n[t],s[t])))return!1;return!0}(t,e);default:return Ga()}}function xc(t,e){return void 0!==(t.values||[]).find((t=>Pc(t,e)))}function Mc(t,e){const n=Oc(t),s=Oc(e);if(n!==s)return hc(n,s);switch(n){case 0:return 0;case 1:return hc(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=kc(t.integerValue||t.doubleValue),s=kc(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return Uc(t.timestampValue,e.timestampValue);case 4:return Uc(Nc(t),Nc(e));case 5:return hc(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Sc(t),s=Sc(e);return n.compareTo(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let t=0;t<n.length&&t<s.length;t++){const e=hc(n[t],s[t]);if(0!==e)return e}return hc(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=hc(kc(t.latitude),kc(e.latitude));return 0!==n?n:hc(kc(t.longitude),kc(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let t=0;t<n.length&&t<s.length;++t){const e=Mc(n[t],s[t]);if(e)return e}return hc(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},s=Object.keys(n),r=e.fields||{},i=Object.keys(r);s.sort(),i.sort();for(let t=0;t<s.length&&t<i.length;++t){const e=hc(s[t],i[t]);if(0!==e)return e;const o=Mc(n[s[t]],r[i[t]]);if(0!==o)return o}return hc(s.length,i.length)}(t.mapValue,e.mapValue);default:throw Ga()}}function Uc(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return hc(t,e);const n=_c(t),s=_c(e),r=hc(n.seconds,s.seconds);return 0!==r?r:hc(n.nanos,s.nanos)}function Fc(t){return Vc(t)}function Vc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=_c(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Sc(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Dc.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const s of t.values||[])n?n=!1:e+=",",e+=Vc(s);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",s=!0;for(const r of e)s?s=!1:n+=",",n+=`${r}:${Vc(t.fields[r])}`;return n+"}"}(t.mapValue):Ga();var e,n}function jc(t){return!!t&&"integerValue"in t}function Bc(t){return!!t&&"arrayValue"in t}function qc(t){return!!t&&"nullValue"in t}function $c(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hc(t){return!!t&&"mapValue"in t}function Kc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return mc(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Kc(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Kc(t.arrayValue.values[n]);return e}return Object.assign({},t)}class zc{constructor(t){this.value=t}static empty(){return new zc({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Hc(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Kc(e)}setAll(t){let e=bc.emptyPath(),n={},s=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,s),n={},s=[],e=r.popLast()}t?n[r.lastSegment()]=Kc(t):s.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,s)}delete(t){const e=this.field(t.popLast());Hc(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Pc(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];Hc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){mc(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new zc(Kc(this.value))}}function Gc(t){const e=[];return mc(t.fields,((t,n)=>{const s=new bc([t]);if(Hc(n)){const t=Gc(n.mapValue).fields;if(0===t.length)e.push(s);else for(const n of t)e.push(s.child(n))}else e.push(s)})),new Tc(e)}class Wc{constructor(t,e,n,s,r){this.key=t,this.documentType=e,this.version=n,this.data=s,this.documentState=r}static newInvalidDocument(t){return new Wc(t,0,fc.min(),zc.empty(),0)}static newFoundDocument(t,e,n){return new Wc(t,1,e,n,0)}static newNoDocument(t,e){return new Wc(t,2,e,zc.empty(),0)}static newUnknownDocument(t,e){return new Wc(t,3,e,zc.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=zc.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=zc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Wc&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}clone(){return new Wc(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Jc{constructor(t,e=null,n=[],s=[],r=null,i=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=i,this.endAt=o,this.R=null}}function Xc(t,e=null,n=[],s=[],r=null,i=null,o=null){return new Jc(t,e,n,s,r,i,o)}function Qc(t){const e=Ja(t);if(null===e.R){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>function(t){return t.field.canonicalString()+t.op.toString()+Fc(t.value)}(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Rc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=hu(e.startAt)),e.endAt&&(t+="|ub:",t+=hu(e.endAt)),e.R=t}return e.R}function Yc(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!du(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!Pc(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!pu(t.startAt,e.startAt)&&pu(t.endAt,e.endAt)}function Zc(t){return Dc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class tu extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.P(t,e,n):new eu(t,e,n):"array-contains"===e?new iu(t,n):"in"===e?new ou(t,n):"not-in"===e?new au(t,n):"array-contains-any"===e?new cu(t,n):new tu(t,e,n)}static P(t,e,n){return"in"===e?new nu(t,n):new su(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.v(Mc(e,this.value)):null!==e&&Oc(this.value)===Oc(e)&&this.v(Mc(e,this.value))}v(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ga()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class eu extends tu{constructor(t,e,n){super(t,e,n),this.key=Dc.fromName(n.referenceValue)}matches(t){const e=Dc.comparator(t.key,this.key);return this.v(e)}}class nu extends tu{constructor(t,e){super(t,"in",e),this.keys=ru(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class su extends tu{constructor(t,e){super(t,"not-in",e),this.keys=ru(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ru(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Dc.fromName(t.referenceValue)))}class iu extends tu{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Bc(e)&&xc(e.arrayValue,this.value)}}class ou extends tu{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&xc(this.value.arrayValue,e)}}class au extends tu{constructor(t,e){super(t,"not-in",e)}matches(t){if(xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!xc(this.value.arrayValue,e)}}class cu extends tu{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Bc(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>xc(this.value.arrayValue,t)))}}class uu{constructor(t,e){this.position=t,this.before=e}}function hu(t){return`${t.before?"b":"a"}:${t.position.map((t=>Fc(t))).join(",")}`}class lu{constructor(t,e="asc"){this.field=t,this.dir=e}}function du(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function fu(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(s=i.field.isKeyField()?Dc.comparator(Dc.fromName(o.referenceValue),n.key):Mc(o,n.data.field(i.field)),"desc"===i.dir&&(s*=-1),0!==s)break}return t.before?s<=0:s<0}function pu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pc(t.position[n],e.position[n]))return!1;return!0}class mu{constructor(t,e=null,n=[],s=[],r=null,i="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=i,this.startAt=o,this.endAt=a,this.S=null,this.D=null,this.startAt,this.endAt}}function gu(t){return new mu(t)}function yu(t){return!Rc(t.limit)&&"F"===t.limitType}function vu(t){return!Rc(t.limit)&&"L"===t.limitType}function wu(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function bu(t){for(const e of t.filters)if(e.V())return e.field;return null}function Tu(t){const e=Ja(t);if(null===e.S){e.S=[];const t=bu(e),n=wu(e);if(null!==t&&null===n)t.isKeyField()||e.S.push(new lu(t)),e.S.push(new lu(bc.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.S.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.S.push(new lu(bc.keyField(),t))}}}return e.S}function Eu(t){const e=Ja(t);if(!e.D)if("F"===e.limitType)e.D=Xc(e.path,e.collectionGroup,Tu(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Tu(e)){const e="desc"===n.dir?"asc":"desc";t.push(new lu(n.field,e))}const n=e.endAt?new uu(e.endAt.position,!e.endAt.before):null,s=e.startAt?new uu(e.startAt.position,!e.startAt.before):null;e.D=Xc(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e.D}function Iu(t,e,n){return new mu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _u(t,e){return Yc(Eu(t),Eu(e))&&t.limitType===e.limitType}function ku(t){return`${Qc(Eu(t))}|lt:${t.limitType}`}function Su(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Fc(e.value)}`;var e})).join(", ")}]`),Rc(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: "+hu(t.startAt)),t.endAt&&(e+=", endAt: "+hu(t.endAt)),`Target(${e})`}(Eu(t))}; limitType=${t.limitType})`}function Au(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Dc.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!fu(t.startAt,Tu(t),e)||t.endAt&&fu(t.endAt,Tu(t),e))}(t,e)}function Cu(t){return(e,n)=>{let s=!1;for(const r of Tu(t)){const t=Nu(r,e,n);if(0!==t)return t;s=s||r.field.isKeyField()}return 0}}function Nu(t,e,n){const s=t.field.isKeyField()?Dc.comparator(e.key,n.key):function(t,e,n){const s=e.data.field(t),r=n.data.field(t);return null!==s&&null!==r?Mc(s,r):Ga()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Ga()}}function Ru(t,e){if(t.C){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lc(e)?"-0":e}}function Lu(t){return{integerValue:""+t}}function Du(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Lc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Lu(e):Ru(t,e)}class Ou{constructor(){this._=void 0}}function Pu(t,e,n){return t instanceof Uu?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Fu?Vu(t,e):t instanceof ju?Bu(t,e):function(t,e){const n=Mu(t,e),s=$u(n)+$u(t.N);return jc(n)&&jc(t.N)?Lu(s):Ru(t.k,s)}(t,e)}function xu(t,e,n){return t instanceof Fu?Vu(t,e):t instanceof ju?Bu(t,e):n}function Mu(t,e){return t instanceof qu?jc(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Uu extends Ou{}class Fu extends Ou{constructor(t){super(),this.elements=t}}function Vu(t,e){const n=Hu(e);for(const e of t.elements)n.some((t=>Pc(t,e)))||n.push(e);return{arrayValue:{values:n}}}class ju extends Ou{constructor(t){super(),this.elements=t}}function Bu(t,e){let n=Hu(e);for(const e of t.elements)n=n.filter((t=>!Pc(t,e)));return{arrayValue:{values:n}}}class qu extends Ou{constructor(t,e){super(),this.k=t,this.N=e}}function $u(t){return kc(t.integerValue||t.doubleValue)}function Hu(t){return Bc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ku{constructor(t,e){this.version=t,this.transformResults=e}}class zu{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new zu}static exists(t){return new zu(void 0,t)}static updateTime(t){return new zu(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Gu(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Wu{}function Ju(t,e,n){t instanceof th?function(t,e,n){const s=t.value.clone(),r=sh(t.fieldTransforms,e,n.transformResults);s.setAll(r),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):t instanceof eh?function(t,e,n){if(!Gu(t.precondition,e))return void e.convertToUnknownDocument(n.version);const s=sh(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(nh(t)),r.setAll(s),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Xu(t,e,n){t instanceof th?function(t,e,n){if(!Gu(t.precondition,e))return;const s=t.value.clone(),r=rh(t.fieldTransforms,n,e);s.setAll(r),e.convertToFoundDocument(Zu(e),s).setHasLocalMutations()}(t,e,n):t instanceof eh?function(t,e,n){if(!Gu(t.precondition,e))return;const s=rh(t.fieldTransforms,n,e),r=e.data;r.setAll(nh(t)),r.setAll(s),e.convertToFoundDocument(Zu(e),r).setHasLocalMutations()}(t,e,n):function(t,e){Gu(t.precondition,e)&&e.convertToNoDocument(fc.min())}(t,e)}function Qu(t,e){let n=null;for(const s of t.fieldTransforms){const t=e.data.field(s.field),r=Mu(s.transform,t||null);null!=r&&(null==n&&(n=zc.empty()),n.set(s.field,r))}return n||null}function Yu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&lc(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Fu&&e instanceof Fu||t instanceof ju&&e instanceof ju?lc(t.elements,e.elements,Pc):t instanceof qu&&e instanceof qu?Pc(t.N,e.N):t instanceof Uu&&e instanceof Uu}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Zu(t){return t.isFoundDocument()?t.version:fc.min()}class th extends Wu{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}}class eh extends Wu{constructor(t,e,n,s,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}}function nh(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function sh(t,e,n){const s=new Map;Wa(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,xu(o,a,n[r]))}return s}function rh(t,e,n){const s=new Map;for(const r of t){const t=r.transform,i=n.data.field(r.field);s.set(r.field,Pu(t,i,e))}return s}class ih extends Wu{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class oh extends Wu{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}class ah{constructor(t){this.count=t}}var ch,uh;function hh(t){if(void 0===t)return Ha("GRPC error has no .code"),Xa.UNKNOWN;switch(t){case ch.OK:return Xa.OK;case ch.CANCELLED:return Xa.CANCELLED;case ch.UNKNOWN:return Xa.UNKNOWN;case ch.DEADLINE_EXCEEDED:return Xa.DEADLINE_EXCEEDED;case ch.RESOURCE_EXHAUSTED:return Xa.RESOURCE_EXHAUSTED;case ch.INTERNAL:return Xa.INTERNAL;case ch.UNAVAILABLE:return Xa.UNAVAILABLE;case ch.UNAUTHENTICATED:return Xa.UNAUTHENTICATED;case ch.INVALID_ARGUMENT:return Xa.INVALID_ARGUMENT;case ch.NOT_FOUND:return Xa.NOT_FOUND;case ch.ALREADY_EXISTS:return Xa.ALREADY_EXISTS;case ch.PERMISSION_DENIED:return Xa.PERMISSION_DENIED;case ch.FAILED_PRECONDITION:return Xa.FAILED_PRECONDITION;case ch.ABORTED:return Xa.ABORTED;case ch.OUT_OF_RANGE:return Xa.OUT_OF_RANGE;case ch.UNIMPLEMENTED:return Xa.UNIMPLEMENTED;case ch.DATA_LOSS:return Xa.DATA_LOSS;default:return Ga()}}(uh=ch||(ch={}))[uh.OK=0]="OK",uh[uh.CANCELLED=1]="CANCELLED",uh[uh.UNKNOWN=2]="UNKNOWN",uh[uh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uh[uh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uh[uh.NOT_FOUND=5]="NOT_FOUND",uh[uh.ALREADY_EXISTS=6]="ALREADY_EXISTS",uh[uh.PERMISSION_DENIED=7]="PERMISSION_DENIED",uh[uh.UNAUTHENTICATED=16]="UNAUTHENTICATED",uh[uh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uh[uh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uh[uh.ABORTED=10]="ABORTED",uh[uh.OUT_OF_RANGE=11]="OUT_OF_RANGE",uh[uh.UNIMPLEMENTED=12]="UNIMPLEMENTED",uh[uh.INTERNAL=13]="INTERNAL",uh[uh.UNAVAILABLE=14]="UNAVAILABLE",uh[uh.DATA_LOSS=15]="DATA_LOSS";class lh{constructor(t,e){this.comparator=t,this.root=e||fh.EMPTY}insert(t,e){return new lh(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,fh.BLACK,null,null))}remove(t){return new lh(this.comparator,this.root.remove(t,this.comparator).copy(null,null,fh.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(0===s)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new dh(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new dh(this.root,t,this.comparator,!1)}getReverseIterator(){return new dh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new dh(this.root,t,this.comparator,!0)}}class dh{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class fh{constructor(t,e,n,s,r){this.key=t,this.value=e,this.color=null!=n?n:fh.RED,this.left=null!=s?s:fh.EMPTY,this.right=null!=r?r:fh.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,r){return new fh(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const r=n(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,e,n),null):0===r?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return fh.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return fh.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,fh.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,fh.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ga();if(this.right.isRed())throw Ga();const t=this.left.check();if(t!==this.right.check())throw Ga();return t+(this.isRed()?0:1)}}fh.EMPTY=null,fh.RED=!0,fh.BLACK=!1,fh.EMPTY=new class{constructor(){this.size=0}get key(){throw Ga()}get value(){throw Ga()}get color(){throw Ga()}get left(){throw Ga()}get right(){throw Ga()}copy(t,e,n,s,r){return this}insert(t,e,n){return new fh(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ph{constructor(t){this.comparator=t,this.data=new lh(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new mh(this.data.getIterator())}getIteratorFrom(t){return new mh(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof ph))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(0!==this.comparator(t,s))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ph(this.comparator);return e.data=t,e}}class mh{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const gh=new lh(Dc.comparator);function yh(){return gh}const vh=new lh(Dc.comparator);function wh(){return vh}const bh=new lh(Dc.comparator);const Th=new ph(Dc.comparator);function Eh(...t){let e=Th;for(const n of t)e=e.add(n);return e}const Ih=new ph(hc);function _h(){return Ih}class kh{constructor(t,e,n,s,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e){const n=new Map;return n.set(t,Sh.createSynthesizedTargetChangeForCurrentChange(t,e)),new kh(fc.min(),n,_h(),yh(),Eh())}}class Sh{constructor(t,e,n,s,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e){return new Sh(Ec.EMPTY_BYTE_STRING,e,Eh(),Eh(),Eh())}}class Ah{constructor(t,e,n,s){this.$=t,this.removedTargetIds=e,this.key=n,this.F=s}}class Ch{constructor(t,e){this.targetId=t,this.O=e}}class Nh{constructor(t,e,n=Ec.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class Rh{constructor(){this.M=0,this.L=Oh(),this.B=Ec.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.M}get j(){return this.q}W(t){t.approximateByteSize()>0&&(this.q=!0,this.B=t)}G(){let t=Eh(),e=Eh(),n=Eh();return this.L.forEach(((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:Ga()}})),new Sh(this.B,this.U,t,e,n)}H(){this.q=!1,this.L=Oh()}J(t,e){this.q=!0,this.L=this.L.insert(t,e)}Y(t){this.q=!0,this.L=this.L.remove(t)}X(){this.M+=1}Z(){this.M-=1}tt(){this.q=!0,this.U=!0}}class Lh{constructor(t){this.et=t,this.nt=new Map,this.st=yh(),this.it=Dh(),this.rt=new ph(hc)}ot(t){for(const e of t.$)t.F&&t.F.isFoundDocument()?this.at(e,t.F):this.ct(e,t.key,t.F);for(const e of t.removedTargetIds)this.ct(e,t.key,t.F)}ut(t){this.forEachTarget(t,(e=>{const n=this.ht(e);switch(t.state){case 0:this.lt(e)&&n.W(t.resumeToken);break;case 1:n.Z(),n.K||n.H(),n.W(t.resumeToken);break;case 2:n.Z(),n.K||this.removeTarget(e);break;case 3:this.lt(e)&&(n.tt(),n.W(t.resumeToken));break;case 4:this.lt(e)&&(this.ft(e),n.W(t.resumeToken));break;default:Ga()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.nt.forEach(((t,n)=>{this.lt(n)&&e(n)}))}dt(t){const e=t.targetId,n=t.O.count,s=this.wt(e);if(s){const t=s.target;if(Zc(t))if(0===n){const n=new Dc(t.path);this.ct(e,n,Wc.newNoDocument(n,fc.min()))}else Wa(1===n);else this._t(e)!==n&&(this.ft(e),this.rt=this.rt.add(e))}}gt(t){const e=new Map;this.nt.forEach(((n,s)=>{const r=this.wt(s);if(r){if(n.current&&Zc(r.target)){const e=new Dc(r.target.path);null!==this.st.get(e)||this.yt(s,e)||this.ct(s,e,Wc.newNoDocument(e,t))}n.j&&(e.set(s,n.G()),n.H())}}));let n=Eh();this.it.forEach(((t,e)=>{let s=!0;e.forEachWhile((t=>{const e=this.wt(t);return!e||2===e.purpose||(s=!1,!1)})),s&&(n=n.add(t))}));const s=new kh(t,e,this.rt,this.st,n);return this.st=yh(),this.it=Dh(),this.rt=new ph(hc),s}at(t,e){if(!this.lt(t))return;const n=this.yt(t,e.key)?2:0;this.ht(t).J(e.key,n),this.st=this.st.insert(e.key,e),this.it=this.it.insert(e.key,this.Tt(e.key).add(t))}ct(t,e,n){if(!this.lt(t))return;const s=this.ht(t);this.yt(t,e)?s.J(e,1):s.Y(e),this.it=this.it.insert(e,this.Tt(e).delete(t)),n&&(this.st=this.st.insert(e,n))}removeTarget(t){this.nt.delete(t)}_t(t){const e=this.ht(t).G();return this.et.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}X(t){this.ht(t).X()}ht(t){let e=this.nt.get(t);return e||(e=new Rh,this.nt.set(t,e)),e}Tt(t){let e=this.it.get(t);return e||(e=new ph(hc),this.it=this.it.insert(t,e)),e}lt(t){const e=null!==this.wt(t);return e||$a("WatchChangeAggregator","Detected inactive target",t),e}wt(t){const e=this.nt.get(t);return e&&e.K?null:this.et.Et(t)}ft(t){this.nt.set(t,new Rh),this.et.getRemoteKeysForTarget(t).forEach((e=>{this.ct(t,e,null)}))}yt(t,e){return this.et.getRemoteKeysForTarget(t).has(e)}}function Dh(){return new lh(Dc.comparator)}function Oh(){return new lh(Dc.comparator)}const Ph={asc:"ASCENDING",desc:"DESCENDING"},xh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Mh{constructor(t,e){this.databaseId=t,this.C=e}}function Uh(t,e){return t.C?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fh(t,e){return t.C?e.toBase64():e.toUint8Array()}function Vh(t,e){return Uh(t,e.toTimestamp())}function jh(t){return Wa(!!t),fc.fromTimestamp(function(t){const e=_c(t);return new dc(e.seconds,e.nanos)}(t))}function Bh(t,e){return function(t){return new vc(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function qh(t){const e=vc.fromString(t);return Wa(cl(e)),e}function $h(t,e){return Bh(t.databaseId,e.path)}function Hh(t,e){const n=qh(e);if(n.get(1)!==t.databaseId.projectId)throw new Qa(Xa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Qa(Xa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Dc(Gh(n))}function Kh(t,e){return Bh(t.databaseId,e)}function zh(t){return new vc(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Gh(t){return Wa(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Wh(t,e,n){return{name:$h(t,e),fields:n.value.mapValue.fields}}function Jh(t,e){return{documents:[Kh(t,e.path)]}}function Xh(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=Kh(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Kh(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if($c(t.value))return{unaryFilter:{field:sl(t.field),op:"IS_NAN"}};if(qc(t.value))return{unaryFilter:{field:sl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if($c(t.value))return{unaryFilter:{field:sl(t.field),op:"IS_NOT_NAN"}};if(qc(t.value))return{unaryFilter:{field:sl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sl(t.field),op:nl(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:sl(t.field),direction:el(t.dir)}}(t)))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(t,e){return t.C||Rc(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Zh(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zh(e.endAt)),n}function Qh(t){let e=function(t){const e=qh(t);return 4===e.length?vc.emptyPath():Gh(e)}(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Wa(1===s);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let i=[];n.where&&(i=Yh(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new lu(rl(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Rc(e)?null:e}(n.limit));let c=null;n.startAt&&(c=tl(n.startAt));let u=null;return n.endAt&&(u=tl(n.endAt)),function(t,e,n,s,r,i,o,a){return new mu(t,e,n,s,r,i,o,a)}(e,r,o,i,a,"F",c,u)}function Yh(t){return t?void 0!==t.unaryFilter?[ol(t)]:void 0!==t.fieldFilter?[il(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Yh(t))).reduce(((t,e)=>t.concat(e))):Ga():[]}function Zh(t){return{before:t.before,values:t.position}}function tl(t){const e=!!t.before,n=t.values||[];return new uu(n,e)}function el(t){return Ph[t]}function nl(t){return xh[t]}function sl(t){return{fieldPath:t.canonicalString()}}function rl(t){return bc.fromServerFormat(t.fieldPath)}function il(t){return tu.create(rl(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ga()}}(t.fieldFilter.op),t.fieldFilter.value)}function ol(t){switch(t.unaryFilter.op){case"IS_NAN":const e=rl(t.unaryFilter.field);return tu.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=rl(t.unaryFilter.field);return tu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=rl(t.unaryFilter.field);return tu.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=rl(t.unaryFilter.field);return tu.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Ga()}}function al(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function cl(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function ul(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ll(e)),e=hl(t.get(n),e);return ll(e)}function hl(t,e){let n=e;const s=t.length;for(let e=0;e<s;e++){const s=t.charAt(e);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function ll(t){return t+""}class dl{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}dl.store="owner",dl.key="owner";class fl{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}fl.store="mutationQueues",fl.keyPath="userId";class pl{constructor(t,e,n,s,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=s,this.mutations=r}}pl.store="mutations",pl.keyPath="batchId",pl.userMutationsIndex="userMutationsIndex",pl.userMutationsKeyPath=["userId","batchId"];class ml{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,ul(e)]}static key(t,e,n){return[t,ul(e),n]}}ml.store="documentMutations",ml.PLACEHOLDER=new ml;class gl{constructor(t,e,n,s,r,i){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=s,this.readTime=r,this.parentPath=i}}gl.store="remoteDocuments",gl.readTimeIndex="readTimeIndex",gl.readTimeIndexPath="readTime",gl.collectionReadTimeIndex="collectionReadTimeIndex",gl.collectionReadTimeIndexPath=["parentPath","readTime"];class yl{constructor(t){this.byteSize=t}}yl.store="remoteDocumentGlobal",yl.key="remoteDocumentGlobalKey";class vl{constructor(t,e,n,s,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=s,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=i,this.query=o}}vl.store="targets",vl.keyPath="targetId",vl.queryTargetsIndexName="queryTargetsIndex",vl.queryTargetsKeyPath=["canonicalId","targetId"];class wl{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}wl.store="targetDocuments",wl.keyPath=["targetId","path"],wl.documentTargetsIndex="documentTargetsIndex",wl.documentTargetsKeyPath=["path","targetId"];class bl{constructor(t,e,n,s){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=s}}bl.key="targetGlobalKey",bl.store="targetGlobal";class Tl{constructor(t,e){this.collectionId=t,this.parent=e}}Tl.store="collectionParents",Tl.keyPath=["collectionId","parent"];class El{constructor(t,e,n,s){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=s}}El.store="clientMetadata",El.keyPath="clientId";class Il{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}Il.store="bundles",Il.keyPath="bundleId";class _l{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}_l.store="namedQueries",_l.keyPath="name",fl.store,pl.store,ml.store,gl.store,vl.store,dl.store,bl.store,wl.store,El.store,yl.store,Tl.store,Il.store,_l.store;class kl{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ga(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new kl(((n,s)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,s)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof kl?e:kl.resolve(e)}catch(t){return kl.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):kl.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):kl.reject(e)}static resolve(t){return new kl(((e,n)=>{e(t)}))}static reject(t){return new kl(((e,n)=>{n(t)}))}static waitFor(t){return new kl(((e,n)=>{let s=0,r=0,i=!1;t.forEach((t=>{++s,t.next((()=>{++r,i&&r===s&&e()}),(t=>n(t)))})),i=!0,r===s&&e()}))}static or(t){let e=kl.resolve(!1);for(const n of t)e=e.next((t=>t?kl.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,s)=>{n.push(e.call(this,t,s))})),this.waitFor(n)}}function Sl(t){return"IndexedDbTransactionError"===t.name}class Al{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const s=this.mutations[e];s.key.isEqual(t.key)&&Ju(s,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&Xu(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&Xu(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),s=n;this.applyToLocalView(s),n.isValidDocument()||s.convertToNoDocument(fc.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Eh())}isEqual(t){return this.batchId===t.batchId&&lc(this.mutations,t.mutations,((t,e)=>Yu(t,e)))&&lc(this.baseMutations,t.baseMutations,((t,e)=>Yu(t,e)))}}class Cl{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){Wa(t.mutations.length===n.length);let s=bh;const r=t.mutations;for(let t=0;t<r.length;t++)s=s.insert(r[t].key,n[t].version);return new Cl(t,e,n,s)}}class Nl{constructor(t,e,n,s,r=fc.min(),i=fc.min(),o=Ec.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o}withSequenceNumber(t){return new Nl(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Nl(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Nl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class Rl{constructor(t){this.Gt=t}}function Ll(t){const e=Qh({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Iu(e,e.limit,"L"):e}class Dl{constructor(){this.zt=new Ol}addToCollectionParentIndex(t,e){return this.zt.add(e),kl.resolve()}getCollectionParents(t,e){return kl.resolve(this.zt.getEntries(e))}}class Ol{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new ph(vc.comparator),r=!s.has(n);return this.index[e]=s.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new ph(vc.comparator)).toArray()}}class Pl{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Pl(t,Pl.DEFAULT_COLLECTION_PERCENTILE,Pl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Pl.DEFAULT_COLLECTION_PERCENTILE=10,Pl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pl.DEFAULT=new Pl(41943040,Pl.DEFAULT_COLLECTION_PERCENTILE,Pl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pl.DISABLED=new Pl(-1,0,0);class xl{constructor(t){this.se=t}next(){return this.se+=2,this.se}static ie(){return new xl(0)}static re(){return new xl(-1)}}async function Ml(t){if(t.code!==Xa.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;$a("LocalStore","Unexpectedly lost primary lease")}class Ul{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,s]of n)if(this.equalsFn(e,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(void 0!==s){for(let n=0;n<s.length;n++)if(this.equalsFn(s[n][0],t))return void(s[n]=[t,e]);s.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return 1===n.length?delete this.inner[e]:n.splice(s,1),!0;return!1}forEach(t){mc(this.inner,((e,n)=>{for(const[e,s]of n)t(e,s)}))}isEmpty(){return gc(this.inner)}}class Fl{constructor(t,e,n){this.Je=t,this.An=e,this.Jt=n}Rn(t,e){return this.An.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Pn(t,e,n)))}Pn(t,e,n){return this.Je.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}bn(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}vn(t,e){return this.Je.getEntries(t,e).next((e=>this.Vn(t,e).next((()=>e))))}Vn(t,e){return this.An.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.bn(e,t)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Dc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Sn(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Dn(t,e,n):this.Cn(t,e,n)}Sn(t,e){return this.Rn(t,new Dc(e)).next((t=>{let e=wh();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Dn(t,e,n){const s=e.collectionGroup;let r=wh();return this.Jt.getCollectionParents(t,s).next((i=>kl.forEach(i,(i=>{const o=function(t,e){return new mu(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,i.child(s));return this.Cn(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}Cn(t,e,n){let s,r;return this.Je.getDocumentsMatchingQuery(t,e,n).next((n=>(s=n,this.An.getAllMutationBatchesAffectingQuery(t,e)))).next((e=>(r=e,this.Nn(t,r,s).next((t=>{s=t;for(const t of r)for(const e of t.mutations){const n=e.key;let r=s.get(n);null==r&&(r=Wc.newInvalidDocument(n),s=s.insert(n,r)),Xu(e,r,t.localWriteTime),r.isFoundDocument()||(s=s.remove(n))}}))))).next((()=>(s.forEach(((t,n)=>{Au(e,n)||(s=s.remove(t))})),s)))}Nn(t,e,n){let s=Eh();for(const t of e)for(const e of t.mutations)e instanceof eh&&null===n.get(e.key)&&(s=s.add(e.key));let r=n;return this.Je.getEntries(t,s).next((t=>(t.forEach(((t,e)=>{e.isFoundDocument()&&(r=r.insert(t,e))})),r)))}}class Vl{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.kn=n,this.xn=s}static $n(t,e){let n=Eh(),s=Eh();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:s=s.add(t.doc.key)}return new Vl(t,e.fromCache,n,s)}}class jl{Fn(t){this.On=t}getDocumentsMatchingQuery(t,e,n,s){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(fc.min())?this.Mn(t,e):this.On.vn(t,s).next((r=>{const i=this.Ln(e,r);return(yu(e)||vu(e))&&this.Bn(e.limitType,i,s,n)?this.Mn(t,e):(qa()<=C.DEBUG&&$a("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Su(e)),this.On.getDocumentsMatchingQuery(t,e,n).next((t=>(i.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}Ln(t,e){let n=new ph(Cu(t));return e.forEach(((e,s)=>{Au(t,s)&&(n=n.add(s))})),n}Bn(t,e,n,s){if(n.size!==e.size)return!0;const r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Mn(t,e){return qa()<=C.DEBUG&&$a("QueryEngine","Using full collection scan to execute query:",Su(e)),this.On.getDocumentsMatchingQuery(t,e,fc.min())}}class Bl{constructor(t,e,n,s){this.persistence=t,this.Un=e,this.k=s,this.qn=new lh(hc),this.Kn=new Ul((t=>Qc(t)),Yc),this.jn=fc.min(),this.An=t.getMutationQueue(n),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new Fl(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.Fn(this.Wn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.qn)))}}async function ql(t,e){const n=Ja(t);let s=n.An,r=n.Wn;const i=await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.An.getAllMutationBatches(t).next((o=>(i=o,s=n.persistence.getMutationQueue(e),r=new Fl(n.Qn,s,n.persistence.getIndexManager()),s.getAllMutationBatches(t)))).next((e=>{const n=[],s=[];let o=Eh();for(const t of i){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return r.vn(t,o).next((t=>({Gn:t,removedBatchIds:n,addedBatchIds:s})))}))}));return n.An=s,n.Wn=r,n.Un.Fn(n.Wn),i}function $l(t){const e=Ja(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.He.getLastRemoteSnapshotVersion(t)))}function Hl(t,e){const n=Ja(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.An.getNextMutationBatchAfterBatchId(t,e))))}async function Kl(t,e,n){const s=Ja(t),r=s.qn.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,(t=>s.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Sl(t))throw t;$a("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}s.qn=s.qn.remove(e),s.Kn.delete(r.target)}function zl(t,e,n){const s=Ja(t);let r=fc.min(),i=Eh();return s.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const s=Ja(t),r=s.Kn.get(n);return void 0!==r?kl.resolve(s.qn.get(r)):s.He.getTargetData(e,n)}(s,t,Eu(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,s.He.getMatchingKeysForTargetId(t,e.targetId).next((t=>{i=t}))})).next((()=>s.Un.getDocumentsMatchingQuery(t,e,n?r:fc.min(),n?i:Eh()))).next((t=>({documents:t,zn:i})))))}class Gl{constructor(t){this.k=t,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(t,e){return kl.resolve(this.Xn.get(e))}saveBundleMetadata(t,e){var n;return this.Xn.set(e.id,{id:(n=e).id,version:n.version,createTime:jh(n.createTime)}),kl.resolve()}getNamedQuery(t,e){return kl.resolve(this.Zn.get(e))}saveNamedQuery(t,e){return this.Zn.set(e.name,function(t){return{name:t.name,query:Ll(t.bundledQuery),readTime:jh(t.readTime)}}(e)),kl.resolve()}}class Wl{constructor(){this.ts=new ph(Jl.es),this.ns=new ph(Jl.ss)}isEmpty(){return this.ts.isEmpty()}addReference(t,e){const n=new Jl(t,e);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}rs(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.os(new Jl(t,e))}cs(t,e){t.forEach((t=>this.removeReference(t,e)))}us(t){const e=new Dc(new vc([])),n=new Jl(e,t),s=new Jl(e,t+1),r=[];return this.ns.forEachInRange([n,s],(t=>{this.os(t),r.push(t.key)})),r}hs(){this.ts.forEach((t=>this.os(t)))}os(t){this.ts=this.ts.delete(t),this.ns=this.ns.delete(t)}ls(t){const e=new Dc(new vc([])),n=new Jl(e,t),s=new Jl(e,t+1);let r=Eh();return this.ns.forEachInRange([n,s],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Jl(t,0),n=this.ts.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Jl{constructor(t,e){this.key=t,this.fs=e}static es(t,e){return Dc.comparator(t.key,e.key)||hc(t.fs,e.fs)}static ss(t,e){return hc(t.fs,e.fs)||Dc.comparator(t.key,e.key)}}class Xl{constructor(t,e){this.Jt=t,this.referenceDelegate=e,this.An=[],this.ds=1,this.ws=new ph(Jl.es)}checkEmpty(t){return kl.resolve(0===this.An.length)}addMutationBatch(t,e,n,s){const r=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];const i=new Al(r,e,n,s);this.An.push(i);for(const e of s)this.ws=this.ws.add(new Jl(e.key,r)),this.Jt.addToCollectionParentIndex(t,e.key.path.popLast());return kl.resolve(i)}lookupMutationBatch(t,e){return kl.resolve(this._s(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.gs(n),r=s<0?0:s;return kl.resolve(this.An.length>r?this.An[r]:null)}getHighestUnacknowledgedBatchId(){return kl.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(t){return kl.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Jl(e,0),s=new Jl(e,Number.POSITIVE_INFINITY),r=[];return this.ws.forEachInRange([n,s],(t=>{const e=this._s(t.fs);r.push(e)})),kl.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ph(hc);return e.forEach((t=>{const e=new Jl(t,0),s=new Jl(t,Number.POSITIVE_INFINITY);this.ws.forEachInRange([e,s],(t=>{n=n.add(t.fs)}))})),kl.resolve(this.ys(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let r=n;Dc.isDocumentKey(r)||(r=r.child(""));const i=new Jl(new Dc(r),0);let o=new ph(hc);return this.ws.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===s&&(o=o.add(t.fs)),!0)}),i),kl.resolve(this.ys(o))}ys(t){const e=[];return t.forEach((t=>{const n=this._s(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Wa(0===this.ps(e.batchId,"removed")),this.An.shift();let n=this.ws;return kl.forEach(e.mutations,(s=>{const r=new Jl(s.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.ws=n}))}ee(t){}containsKey(t,e){const n=new Jl(e,0),s=this.ws.firstAfterOrEqual(n);return kl.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.An.length,kl.resolve()}ps(t,e){return this.gs(t)}gs(t){return 0===this.An.length?0:t-this.An[0].batchId}_s(t){const e=this.gs(t);return e<0||e>=this.An.length?null:this.An[e]}}class Ql{constructor(t,e){this.Jt=t,this.Ts=e,this.docs=new lh(Dc.comparator),this.size=0}addEntry(t,e,n){const s=e.key,r=this.docs.get(s),i=r?r.size:0,o=this.Ts(e);return this.docs=this.docs.insert(s,{document:e.clone(),size:o,readTime:n}),this.size+=o-i,this.Jt.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return kl.resolve(n?n.document.clone():Wc.newInvalidDocument(e))}getEntries(t,e){let n=yh();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.clone():Wc.newInvalidDocument(t))})),kl.resolve(n)}getDocumentsMatchingQuery(t,e,n){let s=yh();const r=new Dc(e.path.child("")),i=this.docs.getIteratorFrom(r);for(;i.hasNext();){const{key:t,value:{document:r,readTime:o}}=i.getNext();if(!e.path.isPrefixOf(t.path))break;o.compareTo(n)<=0||Au(e,r)&&(s=s.insert(r.key,r.clone()))}return kl.resolve(s)}Es(t,e){return kl.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Yl(this)}getSize(t){return kl.resolve(this.size)}}class Yl extends class{constructor(){this.changes=new Ul((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}getReadTime(t){const e=this.changes.get(t);return e?e.readTime:fc.min()}addEntry(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}removeEntry(t,e=null){this.assertNotApplied(),this.changes.set(t,{document:Wc.newInvalidDocument(t),readTime:e})}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?kl.resolve(n.document):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.De=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.document.isValidDocument()?e.push(this.De.addEntry(t,s.document,this.getReadTime(n))):this.De.removeEntry(n)})),kl.waitFor(e)}getFromCache(t,e){return this.De.getEntry(t,e)}getAllFromCache(t,e){return this.De.getEntries(t,e)}}class Zl{constructor(t){this.persistence=t,this.Is=new Ul((t=>Qc(t)),Yc),this.lastRemoteSnapshotVersion=fc.min(),this.highestTargetId=0,this.As=0,this.Rs=new Wl,this.targetCount=0,this.Ps=xl.ie()}forEachTarget(t,e){return this.Is.forEach(((t,n)=>e(n))),kl.resolve()}getLastRemoteSnapshotVersion(t){return kl.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return kl.resolve(this.As)}allocateTargetId(t){return this.highestTargetId=this.Ps.next(),kl.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.As&&(this.As=e),kl.resolve()}ce(t){this.Is.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ps=new xl(e),this.highestTargetId=e),t.sequenceNumber>this.As&&(this.As=t.sequenceNumber)}addTargetData(t,e){return this.ce(e),this.targetCount+=1,kl.resolve()}updateTargetData(t,e){return this.ce(e),kl.resolve()}removeTargetData(t,e){return this.Is.delete(e.target),this.Rs.us(e.targetId),this.targetCount-=1,kl.resolve()}removeTargets(t,e,n){let s=0;const r=[];return this.Is.forEach(((i,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Is.delete(i),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)})),kl.waitFor(r).next((()=>s))}getTargetCount(t){return kl.resolve(this.targetCount)}getTargetData(t,e){const n=this.Is.get(e)||null;return kl.resolve(n)}addMatchingKeys(t,e,n){return this.Rs.rs(e,n),kl.resolve()}removeMatchingKeys(t,e,n){this.Rs.cs(e,n);const s=this.persistence.referenceDelegate,r=[];return s&&e.forEach((e=>{r.push(s.markPotentiallyOrphaned(t,e))})),kl.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Rs.us(e),kl.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Rs.ls(e);return kl.resolve(n)}containsKey(t,e){return kl.resolve(this.Rs.containsKey(e))}}class td{constructor(t,e){this.bs={},this.Be=new ac(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new Zl(this),this.Jt=new Dl,this.Je=function(t,e){return new Ql(t,e)}(this.Jt,(t=>this.referenceDelegate.vs(t))),this.k=new Rl(e),this.Ye=new Gl(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(t){let e=this.bs[t.toKey()];return e||(e=new Xl(this.Jt,this.referenceDelegate),this.bs[t.toKey()]=e),e}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(t,e,n){$a("MemoryPersistence","Starting transaction:",t);const s=new ed(this.Be.next());return this.referenceDelegate.Vs(),n(s).next((t=>this.referenceDelegate.Ss(s).next((()=>t)))).toPromise().then((t=>(s.raiseOnCommittedEvent(),t)))}Ds(t,e){return kl.or(Object.values(this.bs).map((n=>()=>n.containsKey(t,e))))}}class ed extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class nd{constructor(t){this.persistence=t,this.Cs=new Wl,this.Ns=null}static ks(t){return new nd(t)}get xs(){if(this.Ns)return this.Ns;throw Ga()}addReference(t,e,n){return this.Cs.addReference(n,e),this.xs.delete(n.toString()),kl.resolve()}removeReference(t,e,n){return this.Cs.removeReference(n,e),this.xs.add(n.toString()),kl.resolve()}markPotentiallyOrphaned(t,e){return this.xs.add(e.toString()),kl.resolve()}removeTarget(t,e){this.Cs.us(e.targetId).forEach((t=>this.xs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.xs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Vs(){this.Ns=new Set}Ss(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return kl.forEach(this.xs,(n=>{const s=Dc.fromPath(n);return this.$s(t,s).next((t=>{t||e.removeEntry(s)}))})).next((()=>(this.Ns=null,e.apply(t))))}updateLimboDocument(t,e){return this.$s(t,e).next((t=>{t?this.xs.delete(e.toString()):this.xs.add(e.toString())}))}vs(t){return 0}$s(t,e){return kl.or([()=>kl.resolve(this.Cs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ds(t,e)])}}class sd{constructor(){this.activeTargetIds=_h()}Ms(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ls(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Os(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class rd{constructor(){this.pi=new sd,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.pi.Ms(t),this.Ti[t]||"not-current"}updateQueryState(t,e,n){this.Ti[t]=e}removeLocalQueryTarget(t){this.pi.Ls(t)}isLocalQueryTarget(t){return this.pi.activeTargetIds.has(t)}clearQueryState(t){delete this.Ti[t]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(t){return this.pi.activeTargetIds.has(t)}start(){return this.pi=new sd,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class id{Ei(t){}shutdown(){}}class od{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.Pi(),this.bi=[],this.vi()}Ei(t){this.bi.push(t)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){$a("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.bi)t(0)}Pi(){$a("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.bi)t(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const ad={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class cd{constructor(t){this.Vi=t.Vi,this.Si=t.Si}Di(t){this.Ci=t}Ni(t){this.ki=t}onMessage(t){this.xi=t}close(){this.Si()}send(t){this.Vi(t)}$i(){this.Ci()}Fi(t){this.ki(t)}Oi(t){this.xi(t)}}class ud extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.Mi=e+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(t,e,n,s,r){const i=this.Ui(t,e);$a("RestConnection","Sending: ",i,n);const o={};return this.qi(o,s,r),this.Ki(t,i,o,n).then((t=>($a("RestConnection","Received: ",t),t)),(e=>{throw Ka("RestConnection",`${t} failed with error: `,e,"url: ",i,"request:",n),e}))}ji(t,e,n,s,r){return this.Bi(t,e,n,s,r)}qi(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ja,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}Ui(t,e){const n=ad[t];return`${this.Mi}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}Ki(t,e,n,s){return new Promise(((r,i)=>{const o=new Ua;o.listenOnce(Da.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case La.NO_ERROR:const e=o.getResponseJson();$a("Connection","XHR received:",JSON.stringify(e)),r(e);break;case La.TIMEOUT:$a("Connection",'RPC "'+t+'" timed out'),i(new Qa(Xa.DEADLINE_EXCEEDED,"Request time out"));break;case La.HTTP_ERROR:const n=o.getStatus();if($a("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Xa).indexOf(e)>=0?e:Xa.UNKNOWN}(t.status);i(new Qa(e,t.message))}else i(new Qa(Xa.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new Qa(Xa.UNAVAILABLE,"Connection failed."));break;default:Ga()}}finally{$a("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(s);o.send(e,"POST",a,n,15)}))}Qi(t,e,n){const s=[this.Mi,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Na(),i=Ra(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new xa({})),this.qi(l.initMessageHeaders,e,n),a()||u()||o().indexOf("Electron/")>=0||h()||o().indexOf("MSAppHost/")>=0||c()||(l.httpHeadersOverwriteParam="$httpHeaders");const d=s.join("");$a("Connection","Creating WebChannel: "+d,l);const f=r.createWebChannel(d,l);let p=!1,m=!1;const g=new cd({Vi:t=>{m?$a("Connection","Not sending because WebChannel is closed:",t):(p||($a("Connection","Opening WebChannel transport."),f.open(),p=!0),$a("Connection","WebChannel sending:",t),f.send(t))},Si:()=>f.close()}),y=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return y(f,Ma.EventType.OPEN,(()=>{m||$a("Connection","WebChannel transport opened.")})),y(f,Ma.EventType.CLOSE,(()=>{m||(m=!0,$a("Connection","WebChannel transport closed"),g.Fi())})),y(f,Ma.EventType.ERROR,(t=>{m||(m=!0,Ka("Connection","WebChannel transport errored:",t),g.Fi(new Qa(Xa.UNAVAILABLE,"The operation could not be completed")))})),y(f,Ma.EventType.MESSAGE,(t=>{var e;if(!m){const n=t.data[0];Wa(!!n);const s=n,r=s.error||(null===(e=s[0])||void 0===e?void 0:e.error);if(r){$a("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=ch[t];if(void 0!==e)return hh(e)}(t),n=r.message;void 0===e&&(e=Xa.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),m=!0,g.Fi(new Qa(e,n)),f.close()}else $a("Connection","WebChannel received:",n),g.Oi(n)}})),y(i,Oa.STAT_EVENT,(t=>{t.stat===Pa.PROXY?$a("Connection","Detected buffering proxy"):t.stat===Pa.NOPROXY&&$a("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.$i()}),0),g}}function hd(){return"undefined"!=typeof document?document:null}function ld(t){return new Mh(t,!0)}class dd{constructor(t,e,n=1e3,s=1.5,r=6e4){this.Oe=t,this.timerId=e,this.Wi=n,this.Gi=s,this.zi=r,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(t){this.cancel();const e=Math.floor(this.Hi+this.tr()),n=Math.max(0,Date.now()-this.Yi),s=Math.max(0,e-n);s>0&&$a("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Hi} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Ji=this.Oe.enqueueAfterDelay(this.timerId,s,(()=>(this.Yi=Date.now(),t()))),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-.5)*this.Hi}}class fd{constructor(t,e,n,s,r,i,o,a){this.Oe=t,this.nr=n,this.sr=s,this.ir=r,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.rr=0,this.ar=null,this.cr=null,this.stream=null,this.ur=new dd(t,e)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}async stop(){this.hr()&&await this.close(0)}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.ar&&(this.ar=this.Oe.enqueueAfterDelay(this.nr,6e4,(()=>this.mr())))}gr(t){this.yr(),this.stream.send(t)}async mr(){if(this.lr())return this.close(0)}yr(){this.ar&&(this.ar.cancel(),this.ar=null)}pr(){this.cr&&(this.cr.cancel(),this.cr=null)}async close(t,e){this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==t?this.ur.reset():e&&e.code===Xa.RESOURCE_EXHAUSTED?(Ha(e.toString()),Ha("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):e&&e.code===Xa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ni(e)}Tr(){}auth(){this.state=1;const t=this.Er(this.rr),e=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.rr===e&&this.Ir(t,n)}),(e=>{t((()=>{const t=new Qa(Xa.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Ar(t)}))}))}Ir(t,e){const n=this.Er(this.rr);this.stream=this.Rr(t,e),this.stream.Di((()=>{n((()=>(this.state=2,this.cr=this.Oe.enqueueAfterDelay(this.sr,1e4,(()=>(this.lr()&&(this.state=3),Promise.resolve()))),this.listener.Di())))})),this.stream.Ni((t=>{n((()=>this.Ar(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}dr(){this.state=5,this.ur.Zi((async()=>{this.state=0,this.start()}))}Ar(t){return $a("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Er(t){return e=>{this.Oe.enqueueAndForget((()=>this.rr===t?e():($a("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class pd extends fd{constructor(t,e,n,s,r,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,i),this.k=r}Rr(t,e){return this.ir.Qi("Listen",t,e)}onMessage(t){this.ur.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ga()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(t,e){return t.C?(Wa(void 0===e||"string"==typeof e),Ec.fromBase64String(e||"")):(Wa(void 0===e||e instanceof Uint8Array),Ec.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Xa.UNKNOWN:hh(t.code);return new Qa(e,t.message||"")}(o);n=new Nh(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Hh(t,s.document.name),i=jh(s.document.updateTime),o=new zc({mapValue:{fields:s.document.fields}}),a=Wc.newFoundDocument(r,i,o),c=s.targetIds||[],u=s.removedTargetIds||[];n=new Ah(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Hh(t,s.document),i=s.readTime?jh(s.readTime):fc.min(),o=Wc.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Ah([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Hh(t,s.document),i=s.removedTargetIds||[];n=new Ah([],i,r,null)}else{if(!("filter"in e))return Ga();{e.filter;const t=e.filter;t.targetId;const s=t.count||0,r=new ah(s),i=t.targetId;n=new Ch(i,r)}}return n}(this.k,t),n=function(t){if(!("targetChange"in t))return fc.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?fc.min():e.readTime?jh(e.readTime):fc.min()}(t);return this.listener.Pr(e,n)}br(t){const e={};e.database=zh(this.k),e.addTarget=function(t,e){let n;const s=e.target;return n=Zc(s)?{documents:Jh(t,s)}:{query:Xh(t,s)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Fh(t,e.resumeToken):e.snapshotVersion.compareTo(fc.min())>0&&(n.readTime=Uh(t,e.snapshotVersion.toTimestamp())),n}(this.k,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ga()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.k,t);n&&(e.labels=n),this.gr(e)}vr(t){const e={};e.database=zh(this.k),e.removeTarget=t,this.gr(e)}}class md extends fd{constructor(t,e,n,s,r,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,i),this.k=r,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(t,e){return this.ir.Qi("Write",t,e)}onMessage(t){if(Wa(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.ur.reset();const e=function(t,e){return t&&t.length>0?(Wa(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?jh(t.updateTime):jh(e);return n.isEqual(fc.min())&&(n=jh(e)),new Ku(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=jh(t.commitTime);return this.listener.Cr(n,e)}return Wa(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const t={};t.database=zh(this.k),this.gr(t)}Dr(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof th)n={update:Wh(t,e.key,e.value)};else if(e instanceof ih)n={delete:$h(t,e.key)};else if(e instanceof eh)n={update:Wh(t,e.key,e.data),updateMask:al(e.fieldMask)};else{if(!(e instanceof oh))return Ga();n={verify:$h(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Uu)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Fu)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ju)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof qu)return{fieldPath:e.field.canonicalString(),increment:n.N};throw Ga()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Vh(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ga()}(t,e.precondition)),n}(this.k,t)))};this.gr(e)}}class gd extends class{}{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.ir=n,this.k=s,this.$r=!1}Fr(){if(this.$r)throw new Qa(Xa.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(t,e,n){return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.ir.Bi(t,e,n,s,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Qa(Xa.UNKNOWN,t.toString())}))}ji(t,e,n){return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.ir.ji(t,e,n,s,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Qa(Xa.UNKNOWN,t.toString())}))}terminate(){this.$r=!0}}class yd{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Or=0,this.Mr=null,this.Lr=!0}Br(){0===this.Or&&(this.Ur("Unknown"),this.Mr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.Mr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve()))))}Kr(t){"Online"===this.state?this.Ur("Unknown"):(this.Or++,this.Or>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Ur("Offline")))}set(t){this.jr(),this.Or=0,"Online"===t&&(this.Lr=!1),this.Ur(t)}Ur(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}qr(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(Ha(e),this.Lr=!1):$a("OnlineStateTracker",e)}jr(){null!==this.Mr&&(this.Mr.cancel(),this.Mr=null)}}class vd{constructor(t,e,n,s,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=r,this.Hr.Ei((t=>{n.enqueueAndForget((async()=>{Ad(this)&&($a("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Ja(t);e.Gr.add(4),await bd(e),e.Jr.set("Unknown"),e.Gr.delete(4),await wd(e)}(this))}))})),this.Jr=new yd(n,s)}}async function wd(t){if(Ad(t))for(const e of t.zr)await e(!0)}async function bd(t){for(const e of t.zr)await e(!1)}function Td(t,e){const n=Ja(t);n.Wr.has(e.targetId)||(n.Wr.set(e.targetId,e),Sd(n)?kd(n):$d(n).lr()&&Id(n,e))}function Ed(t,e){const n=Ja(t),s=$d(n);n.Wr.delete(e),s.lr()&&_d(n,e),0===n.Wr.size&&(s.lr()?s._r():Ad(n)&&n.Jr.set("Unknown"))}function Id(t,e){t.Yr.X(e.targetId),$d(t).br(e)}function _d(t,e){t.Yr.X(e),$d(t).vr(e)}function kd(t){t.Yr=new Lh({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Wr.get(e)||null}),$d(t).start(),t.Jr.Br()}function Sd(t){return Ad(t)&&!$d(t).hr()&&t.Wr.size>0}function Ad(t){return 0===Ja(t).Gr.size}function Cd(t){t.Yr=void 0}async function Nd(t){t.Wr.forEach(((e,n)=>{Id(t,e)}))}async function Rd(t,e){Cd(t),Sd(t)?(t.Jr.Kr(e),kd(t)):t.Jr.set("Unknown")}async function Ld(t,e,n){if(t.Jr.set("Online"),e instanceof Nh&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const s of e.targetIds)t.Wr.has(s)&&(await t.remoteSyncer.rejectListen(s,n),t.Wr.delete(s),t.Yr.removeTarget(s))}(t,e)}catch(n){$a("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Dd(t,n)}else if(e instanceof Ah?t.Yr.ot(e):e instanceof Ch?t.Yr.dt(e):t.Yr.ut(e),!n.isEqual(fc.min()))try{const e=await $l(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Yr.gt(e);return n.targetChanges.forEach(((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.Wr.get(s);r&&t.Wr.set(s,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.Wr.get(e);if(!n)return;t.Wr.set(e,n.withResumeToken(Ec.EMPTY_BYTE_STRING,n.snapshotVersion)),_d(t,e);const s=new Nl(n.target,e,1,n.sequenceNumber);Id(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){$a("RemoteStore","Failed to raise snapshot:",e),await Dd(t,e)}}async function Dd(t,e,n){if(!Sl(e))throw e;t.Gr.add(1),await bd(t),t.Jr.set("Offline"),n||(n=()=>$l(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{$a("RemoteStore","Retrying IndexedDB access"),await n(),t.Gr.delete(1),await wd(t)}))}function Od(t,e){return e().catch((n=>Dd(t,n,e)))}async function Pd(t){const e=Ja(t),n=Hd(e);let s=e.Qr.length>0?e.Qr[e.Qr.length-1].batchId:-1;for(;xd(e);)try{const t=await Hl(e.localStore,s);if(null===t){0===e.Qr.length&&n._r();break}s=t.batchId,Md(e,t)}catch(t){await Dd(e,t)}Ud(e)&&Fd(e)}function xd(t){return Ad(t)&&t.Qr.length<10}function Md(t,e){t.Qr.push(e);const n=Hd(t);n.lr()&&n.Sr&&n.Dr(e.mutations)}function Ud(t){return Ad(t)&&!Hd(t).hr()&&t.Qr.length>0}function Fd(t){Hd(t).start()}async function Vd(t){Hd(t).kr()}async function jd(t){const e=Hd(t);for(const n of t.Qr)e.Dr(n.mutations)}async function Bd(t,e,n){const s=t.Qr.shift(),r=Cl.from(s,e,n);await Od(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await Pd(t)}async function qd(t,e){e&&Hd(t).Sr&&await async function(t,e){if(function(t){switch(t){default:return Ga();case Xa.CANCELLED:case Xa.UNKNOWN:case Xa.DEADLINE_EXCEEDED:case Xa.RESOURCE_EXHAUSTED:case Xa.INTERNAL:case Xa.UNAVAILABLE:case Xa.UNAUTHENTICATED:return!1;case Xa.INVALID_ARGUMENT:case Xa.NOT_FOUND:case Xa.ALREADY_EXISTS:case Xa.PERMISSION_DENIED:case Xa.FAILED_PRECONDITION:case Xa.ABORTED:case Xa.OUT_OF_RANGE:case Xa.UNIMPLEMENTED:case Xa.DATA_LOSS:return!0}}(n=e.code)&&n!==Xa.ABORTED){const n=t.Qr.shift();Hd(t).wr(),await Od(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Pd(t)}var n}(t,e),Ud(t)&&Fd(t)}function $d(t){return t.Xr||(t.Xr=function(t,e,n){const s=Ja(t);return s.Fr(),new pd(e,s.ir,s.authCredentials,s.appCheckCredentials,s.k,n)}(t.datastore,t.asyncQueue,{Di:Nd.bind(null,t),Ni:Rd.bind(null,t),Pr:Ld.bind(null,t)}),t.zr.push((async e=>{e?(t.Xr.wr(),Sd(t)?kd(t):t.Jr.set("Unknown")):(await t.Xr.stop(),Cd(t))}))),t.Xr}function Hd(t){return t.Zr||(t.Zr=function(t,e,n){const s=Ja(t);return s.Fr(),new md(e,s.ir,s.authCredentials,s.appCheckCredentials,s.k,n)}(t.datastore,t.asyncQueue,{Di:Vd.bind(null,t),Ni:qd.bind(null,t),Nr:jd.bind(null,t),Cr:Bd.bind(null,t)}),t.zr.push((async e=>{e?(t.Zr.wr(),await Pd(t)):(await t.Zr.stop(),t.Qr.length>0&&($a("RemoteStore",`Stopping write stream with ${t.Qr.length} pending writes`),t.Qr=[]))}))),t.Zr}class Kd{constructor(t,e,n,s,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new Ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,s,r){const i=Date.now()+n,o=new Kd(t,e,i,s,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Qa(Xa.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zd(t,e){if(Ha("AsyncQueue",`${e}: ${t}`),Sl(t))return new Qa(Xa.UNAVAILABLE,`${e}: ${t}`);throw t}class Gd{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Dc.comparator(e.key,n.key):(t,e)=>Dc.comparator(t.key,e.key),this.keyedMap=wh(),this.sortedSet=new lh(this.comparator)}static emptySet(t){return new Gd(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Gd))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(!t.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Gd;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Wd{constructor(){this.eo=new lh(Dc.comparator)}track(t){const e=t.doc.key,n=this.eo.get(e);n?0!==t.type&&3===n.type?this.eo=this.eo.insert(e,t):3===t.type&&1!==n.type?this.eo=this.eo.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.eo=this.eo.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.eo=this.eo.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.eo=this.eo.remove(e):1===t.type&&2===n.type?this.eo=this.eo.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.eo=this.eo.insert(e,{type:2,doc:t.doc}):Ga():this.eo=this.eo.insert(e,t)}no(){const t=[];return this.eo.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Jd{constructor(t,e,n,s,r,i,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(t,e,n,s){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new Jd(t,e,Gd.emptySet(e),r,n,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Xd{constructor(){this.so=void 0,this.listeners=[]}}class Qd{constructor(){this.queries=new Ul((t=>ku(t)),_u),this.onlineState="Unknown",this.io=new Set}}async function Yd(t,e){const n=Ja(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new Xd),r)try{i.so=await n.onListen(s)}catch(t){const n=zd(t,`Initialization of query '${Su(e.query)}' failed`);return void e.onError(n)}n.queries.set(s,i),i.listeners.push(e),e.ro(n.onlineState),i.so&&e.oo(i.so)&&nf(n)}async function Zd(t,e){const n=Ja(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const t=i.listeners.indexOf(e);t>=0&&(i.listeners.splice(t,1),r=0===i.listeners.length)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function tf(t,e){const n=Ja(t);let s=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.listeners)e.oo(t)&&(s=!0);r.so=t}}s&&nf(n)}function ef(t,e,n){const s=Ja(t),r=s.queries.get(e);if(r)for(const t of r.listeners)t.onError(n);s.queries.delete(e)}function nf(t){t.io.forEach((t=>{t.next()}))}class sf{constructor(t,e,n){this.query=t,this.ao=e,this.co=!1,this.uo=null,this.onlineState="Unknown",this.options=n||{}}oo(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Jd(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let e=!1;return this.co?this.ho(t)&&(this.ao.next(t),e=!0):this.lo(t,this.onlineState)&&(this.fo(t),e=!0),this.uo=t,e}onError(t){this.ao.error(t)}ro(t){this.onlineState=t;let e=!1;return this.uo&&!this.co&&this.lo(this.uo,t)&&(this.fo(this.uo),e=!0),e}lo(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options.wo&&n||t.docs.isEmpty()&&"Offline"!==e)}ho(t){if(t.docChanges.length>0)return!0;const e=this.uo&&this.uo.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}fo(t){t=Jd.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.co=!0,this.ao.next(t)}}class rf{constructor(t){this.key=t}}class of{constructor(t){this.key=t}}class af{constructor(t,e){this.query=t,this.To=e,this.Eo=null,this.current=!1,this.Io=Eh(),this.mutatedKeys=Eh(),this.Ao=Cu(t),this.Ro=new Gd(this.Ao)}get Po(){return this.To}bo(t,e){const n=e?e.vo:new Wd,s=e?e.Ro:this.Ro;let r=e?e.mutatedKeys:this.mutatedKeys,i=s,o=!1;const a=yu(this.query)&&s.size===this.query.limit?s.last():null,c=vu(this.query)&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((t,e)=>{const u=s.get(t),h=Au(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Vo(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Ao(h,a)>0||c&&this.Ao(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(i=i.add(h),r=d?r.add(t):r.delete(t)):(i=i.delete(t),r=r.delete(t)))})),yu(this.query)||vu(this.query))for(;i.size>this.query.limit;){const t=yu(this.query)?i.last():i.first();i=i.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Ro:i,vo:n,Bn:o,mutatedKeys:r}}Vo(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const s=this.Ro;this.Ro=t.Ro,this.mutatedKeys=t.mutatedKeys;const r=t.vo.no();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ga()}};return n(t)-n(e)}(t.type,e.type)||this.Ao(t.doc,e.doc))),this.So(n);const i=e?this.Do():[],o=0===this.Io.size&&this.current?1:0,a=o!==this.Eo;return this.Eo=o,0!==r.length||a?{snapshot:new Jd(this.query,t.Ro,s,r,t.mutatedKeys,0===o,a,!1),Co:i}:{Co:i}}ro(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new Wd,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(t){return!this.To.has(t)&&!!this.Ro.has(t)&&!this.Ro.get(t).hasLocalMutations}So(t){t&&(t.addedDocuments.forEach((t=>this.To=this.To.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.To=this.To.delete(t))),this.current=t.current)}Do(){if(!this.current)return[];const t=this.Io;this.Io=Eh(),this.Ro.forEach((t=>{this.No(t.key)&&(this.Io=this.Io.add(t.key))}));const e=[];return t.forEach((t=>{this.Io.has(t)||e.push(new of(t))})),this.Io.forEach((n=>{t.has(n)||e.push(new rf(n))})),e}ko(t){this.To=t.zn,this.Io=Eh();const e=this.bo(t.documents);return this.applyChanges(e,!0)}xo(){return Jd.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class cf{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class uf{constructor(t){this.key=t,this.$o=!1}}class hf{constructor(t,e,n,s,r,i){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=i,this.Fo={},this.Oo=new Ul((t=>ku(t)),_u),this.Mo=new Map,this.Lo=new Set,this.Bo=new lh(Dc.comparator),this.Uo=new Map,this.qo=new Wl,this.Ko={},this.jo=new Map,this.Qo=xl.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}async function lf(t,e){const n=function(t){const e=Ja(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ff.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Af.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mf.bind(null,e),e.Fo.Pr=tf.bind(null,e.eventManager),e.Fo.zo=ef.bind(null,e.eventManager),e}(t);let s,r;const i=n.Oo.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.xo();else{const t=await function(t,e){const n=Ja(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let s;return n.He.getTargetData(t,e).next((r=>r?(s=r,kl.resolve(s)):n.He.allocateTargetId(t).next((r=>(s=new Nl(e,r,0,t.currentSequenceNumber),n.He.addTargetData(t,s).next((()=>s)))))))})).then((t=>{const s=n.qn.get(t.targetId);return(null===s||t.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.qn=n.qn.insert(t.targetId,t),n.Kn.set(e,t.targetId)),t}))}(n.localStore,Eu(e)),i=n.sharedClientState.addLocalQueryTarget(t.targetId);s=t.targetId,r=await async function(t,e,n,s){t.Go=(e,n,s)=>async function(t,e,n,s){let r=e.view.bo(n);r.Bn&&(r=await zl(t.localStore,e.query,!1).then((({documents:t})=>e.view.bo(t,r))));const i=s&&s.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,i);return Ef(t,e.targetId,o.Co),o.snapshot}(t,e,n,s);const r=await zl(t.localStore,e,!0),i=new af(e,r.zn),o=i.bo(r.documents),a=Sh.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==t.onlineState),c=i.applyChanges(o,t.isPrimaryClient,a);Ef(t,n,c.Co);const u=new cf(e,n,i);return t.Oo.set(e,u),t.Mo.has(n)?t.Mo.get(n).push(e):t.Mo.set(n,[e]),c.snapshot}(n,e,s,"current"===i),n.isPrimaryClient&&Td(n.remoteStore,t)}return r}async function df(t,e){const n=Ja(t),s=n.Oo.get(e),r=n.Mo.get(s.targetId);if(r.length>1)return n.Mo.set(s.targetId,r.filter((t=>!_u(t,e)))),void n.Oo.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Kl(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),Ed(n.remoteStore,s.targetId),bf(n,s.targetId)})).catch(Ml)):(bf(n,s.targetId),await Kl(n.localStore,s.targetId,!0))}async function ff(t,e){const n=Ja(t);try{const t=await function(t,e){const n=Ja(t),s=e.snapshotVersion;let r=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const i=n.Qn.newChangeBuffer({trackRemovals:!0});r=n.qn;const o=[];e.targetChanges.forEach(((e,i)=>{const a=r.get(i);if(!a)return;o.push(n.He.removeMatchingKeys(t,e.removedDocuments,i).next((()=>n.He.addMatchingKeys(t,e.addedDocuments,i))));const c=e.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,s).withSequenceNumber(t.currentSequenceNumber);r=r.insert(i,u),function(t,e,n){return Wa(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,e)&&o.push(n.He.updateTargetData(t,u))}}));let a=yh();if(e.documentUpdates.forEach(((s,r)=>{e.resolvedLimboDocuments.has(s)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,s))})),o.push(function(t,e,n,s,r){let i=Eh();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=yh();return n.forEach(((n,o)=>{const a=t.get(n),c=(null==r?void 0:r.get(n))||s;o.isNoDocument()&&o.version.isEqual(fc.min())?(e.removeEntry(n,c),i=i.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(o,c),i=i.insert(n,o)):$a("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),i}))}(t,i,e.documentUpdates,s,void 0).next((t=>{a=t}))),!s.isEqual(fc.min())){const e=n.He.getLastRemoteSnapshotVersion(t).next((e=>n.He.setTargetsMetadata(t,t.currentSequenceNumber,s)));o.push(e)}return kl.waitFor(o).next((()=>i.apply(t))).next((()=>n.Wn.Vn(t,a))).next((()=>a))})).then((t=>(n.qn=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const s=n.Uo.get(e);s&&(Wa(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?s.$o=!0:t.modifiedDocuments.size>0?Wa(s.$o):t.removedDocuments.size>0&&(Wa(s.$o),s.$o=!1))})),await kf(n,t,e)}catch(t){await Ml(t)}}function pf(t,e,n){const s=Ja(t);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const t=[];s.Oo.forEach(((n,s)=>{const r=s.view.ro(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Ja(t);n.onlineState=e;let s=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.ro(e)&&(s=!0)})),s&&nf(n)}(s.eventManager,e),t.length&&s.Fo.Pr(t),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function mf(t,e,n){const s=Ja(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Uo.get(e),i=r&&r.key;if(i){let t=new lh(Dc.comparator);t=t.insert(i,Wc.newNoDocument(i,fc.min()));const n=Eh().add(i),r=new kh(fc.min(),new Map,new ph(hc),t,n);await ff(s,r),s.Bo=s.Bo.remove(i),s.Uo.delete(e),_f(s)}else await Kl(s.localStore,e,!1).then((()=>bf(s,e,n))).catch(Ml)}async function gf(t,e){const n=Ja(t),s=e.batch.batchId;try{const t=await function(t,e){const n=Ja(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const s=e.batch.keys(),r=n.Qn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,s){const r=n.batch,i=r.keys();let o=kl.resolve();return i.forEach((t=>{o=o.next((()=>s.getEntry(e,t))).next((e=>{const i=n.docVersions.get(t);Wa(null!==i),e.version.compareTo(i)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&s.addEntry(e,n.commitVersion))}))})),o.next((()=>t.An.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.An.performConsistencyCheck(t))).next((()=>n.Wn.vn(t,s)))}))}(n.localStore,e);wf(n,s,null),vf(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await kf(n,t)}catch(t){await Ml(t)}}async function yf(t,e,n){const s=Ja(t);try{const t=await function(t,e){const n=Ja(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let s;return n.An.lookupMutationBatch(t,e).next((e=>(Wa(null!==e),s=e.keys(),n.An.removeMutationBatch(t,e)))).next((()=>n.An.performConsistencyCheck(t))).next((()=>n.Wn.vn(t,s)))}))}(s.localStore,e);wf(s,e,n),vf(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await kf(s,t)}catch(n){await Ml(n)}}function vf(t,e){(t.jo.get(e)||[]).forEach((t=>{t.resolve()})),t.jo.delete(e)}function wf(t,e,n){const s=Ja(t);let r=s.Ko[s.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),s.Ko[s.currentUser.toKey()]=r}}function bf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Mo.get(e))t.Oo.delete(s),n&&t.Fo.zo(s,n);t.Mo.delete(e),t.isPrimaryClient&&t.qo.us(e).forEach((e=>{t.qo.containsKey(e)||Tf(t,e)}))}function Tf(t,e){t.Lo.delete(e.path.canonicalString());const n=t.Bo.get(e);null!==n&&(Ed(t.remoteStore,n),t.Bo=t.Bo.remove(e),t.Uo.delete(n),_f(t))}function Ef(t,e,n){for(const s of n)s instanceof rf?(t.qo.addReference(s.key,e),If(t,s)):s instanceof of?($a("SyncEngine","Document no longer in limbo: "+s.key),t.qo.removeReference(s.key,e),t.qo.containsKey(s.key)||Tf(t,s.key)):Ga()}function If(t,e){const n=e.key,s=n.path.canonicalString();t.Bo.get(n)||t.Lo.has(s)||($a("SyncEngine","New document in limbo: "+n),t.Lo.add(s),_f(t))}function _f(t){for(;t.Lo.size>0&&t.Bo.size<t.maxConcurrentLimboResolutions;){const e=t.Lo.values().next().value;t.Lo.delete(e);const n=new Dc(vc.fromString(e)),s=t.Qo.next();t.Uo.set(s,new uf(n)),t.Bo=t.Bo.insert(n,s),Td(t.remoteStore,new Nl(Eu(gu(n.path)),s,2,ac.I))}}async function kf(t,e,n){const s=Ja(t),r=[],i=[],o=[];s.Oo.isEmpty()||(s.Oo.forEach(((t,a)=>{o.push(s.Go(a,e,n).then((t=>{if(t){s.isPrimaryClient&&s.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=Vl.$n(a.targetId,t);i.push(e)}})))})),await Promise.all(o),s.Fo.Pr(r),await async function(t,e){const n=Ja(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>kl.forEach(e,(e=>kl.forEach(e.kn,(s=>n.persistence.referenceDelegate.addReference(t,e.targetId,s))).next((()=>kl.forEach(e.xn,(s=>n.persistence.referenceDelegate.removeReference(t,e.targetId,s)))))))))}catch(t){if(!Sl(t))throw t;$a("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.qn.get(e),s=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(s);n.qn=n.qn.insert(e,r)}}}(s.localStore,i))}async function Sf(t,e){const n=Ja(t);if(!n.currentUser.isEqual(e)){$a("SyncEngine","User change. New user:",e.toKey());const t=await ql(n.localStore,e);n.currentUser=e,function(t,e){t.jo.forEach((t=>{t.forEach((t=>{t.reject(new Qa(Xa.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.jo.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await kf(n,t.Gn)}}function Af(t,e){const n=Ja(t),s=n.Uo.get(e);if(s&&s.$o)return Eh().add(s.key);{let t=Eh();const s=n.Mo.get(e);if(!s)return t;for(const e of s){const s=n.Oo.get(e);t=t.unionWith(s.view.Po)}return t}}function Cf(t){const e=Ja(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yf.bind(null,e),e}class Nf{constructor(){this.synchronizeTabs=!1}async initialize(t){this.k=ld(t.databaseInfo.databaseId),this.sharedClientState=this.Jo(t),this.persistence=this.Yo(t),await this.persistence.start(),this.gcScheduler=this.Xo(t),this.localStore=this.Zo(t)}Xo(t){return null}Zo(t){return function(t,e,n,s){return new Bl(t,e,n,s)}(this.persistence,new jl,t.initialUser,this.k)}Yo(t){return new td(nd.ks,this.k)}Jo(t){return new rd}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Rf{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>pf(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sf.bind(null,this.syncEngine),await async function(t,e){const n=Ja(t);e?(n.Gr.delete(2),await wd(n)):e||(n.Gr.add(2),await bd(n),n.Jr.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Qd}createDatastore(t){const e=ld(t.databaseInfo.databaseId),n=(s=t.databaseInfo,new ud(s));var s;return function(t,e,n,s){return new gd(t,e,n,s)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,s=t.asyncQueue,r=t=>pf(this.syncEngine,t,0),i=od.bt()?new od:new id,new vd(e,n,s,r,i);var e,n,s,r,i}createSyncEngine(t,e){return function(t,e,n,s,r,i,o){const a=new hf(t,e,n,s,r,i);return o&&(a.Wo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Ja(t);$a("RemoteStore","RemoteStore shutting down."),e.Gr.add(5),await bd(e),e.Hr.shutdown(),e.Jr.set("Unknown")}(this.remoteStore)}}class Lf{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.ea(this.observer.next,t)}error(t){this.observer.error?this.ea(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}na(){this.muted=!0}ea(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Df{constructor(t,e,n,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=Va.UNAUTHENTICATED,this.clientId=uc.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{$a("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(()=>Promise.resolve()))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Qa(Xa.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=zd(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Of(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||($a("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),$a("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async t=>{s.isEqual(t)||(await ql(e.localStore,t),s=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Nf)),t.offlineComponents}(t);$a("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener((t=>async function(t,e){const n=Ja(t);n.asyncQueue.verifyOperationInProgress(),$a("RemoteStore","RemoteStore received new credentials");const s=Ad(n);n.Gr.add(3),await bd(n),s&&n.Jr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Gr.delete(3),await wd(n)}(e.remoteStore,t))),t.onlineComponents=e}async function Pf(t){return t.onlineComponents||($a("FirestoreClient","Using default OnlineComponentProvider"),await Of(t,new Rf)),t.onlineComponents}async function xf(t){const e=await Pf(t),n=e.eventManager;return n.onListen=lf.bind(null,e.syncEngine),n.onUnlisten=df.bind(null,e.syncEngine),n}class Mf{constructor(t,e,n,s,r,i,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Uf{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Uf&&t.projectId===this.projectId&&t.database===this.database}}const Ff=new Map;function Vf(t,e,n){if(!n)throw new Qa(Xa.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function jf(t){if(!Dc.isDocumentKey(t))throw new Qa(Xa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Bf(t){if(Dc.isDocumentKey(t))throw new Qa(Xa.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ga()}function $f(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Qa(Xa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qf(t);throw new Qa(Xa.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Hf{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Qa(Xa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Qa(Xa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,s){if(!0===e&&!0===s)throw new Qa(Xa.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Kf{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hf({}),this._settingsFrozen=!1,t instanceof Uf?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Qa(Xa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Uf(t.options.projectId)}(t))}get app(){if(!this._app)throw new Qa(Xa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Qa(Xa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hf(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new tc;switch(t.type){case"gapi":const e=t.client;return Wa(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new rc(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Qa(Xa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ff.get(t);e&&($a("ComponentProvider","Removing Datastore"),Ff.delete(t),e.terminate())}(this),Promise.resolve()}}class zf{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wf(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new zf(this.firestore,t,this._key)}}class Gf{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Gf(this.firestore,t,this._query)}}class Wf extends Gf{constructor(t,e,n){super(t,e,gu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new zf(this.firestore,null,new Dc(t))}withConverter(t){return new Wf(this.firestore,t,this._path)}}function Jf(t,e,...n){if(t=E(t),1===arguments.length&&(e=uc.A()),Vf("doc","path",e),t instanceof Kf){const s=vc.fromString(e,...n);return jf(s),new zf(t,null,new Dc(s))}{if(!(t instanceof zf||t instanceof Wf))throw new Qa(Xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(vc.fromString(e,...n));return jf(s),new zf(t.firestore,t instanceof Wf?t.converter:null,new Dc(s))}}class Xf{constructor(){this.ma=Promise.resolve(),this.ga=[],this.ya=!1,this.pa=[],this.Ta=null,this.Ea=!1,this.Ia=!1,this.Aa=[],this.ur=new dd(this,"async_queue_retry"),this.Ra=()=>{const t=hd();t&&$a("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ur.er()};const t=hd();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ra)}get isShuttingDown(){return this.ya}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Pa(),this.ba(t)}enterRestrictedMode(t){if(!this.ya){this.ya=!0,this.Ia=t||!1;const e=hd();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ra)}}enqueue(t){if(this.Pa(),this.ya)return new Promise((()=>{}));const e=new Ya;return this.ba((()=>this.ya&&this.Ia?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.ga.push(t),this.va())))}async va(){if(0!==this.ga.length){try{await this.ga[0](),this.ga.shift(),this.ur.reset()}catch(t){if(!Sl(t))throw t;$a("AsyncQueue","Operation failed with retryable error: "+t)}this.ga.length>0&&this.ur.Zi((()=>this.va()))}}ba(t){const e=this.ma.then((()=>(this.Ea=!0,t().catch((t=>{this.Ta=t,this.Ea=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Ha("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Ea=!1,t))))));return this.ma=e,e}enqueueAfterDelay(t,e,n){this.Pa(),this.Aa.indexOf(t)>-1&&(e=0);const s=Kd.createAndSchedule(this,t,e,n,(t=>this.Va(t)));return this.pa.push(s),s}Pa(){this.Ta&&Ga()}verifyOperationInProgress(){}async Sa(){let t;do{t=this.ma,await t}while(t!==this.ma)}Da(t){for(const e of this.pa)if(e.timerId===t)return!0;return!1}Ca(t){return this.Sa().then((()=>{this.pa.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.pa)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Sa()}))}Na(t){this.Aa.push(t)}Va(t){const e=this.pa.indexOf(t);this.pa.splice(e,1)}}function Qf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class Yf extends Kf{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new Xf,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||tp(this),this._firestoreClient.terminate()}}function Zf(t){return t._firestoreClient||tp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function tp(t){var e;const n=t._freezeSettings(),s=function(t,e,n,s){return new Mf(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Df(t._authCredentials,t._appCheckCredentials,t._queue,s)}class ep{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Qa(Xa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bc(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class np{constructor(t){this._byteString=t}static fromBase64String(t){try{return new np(Ec.fromBase64String(t))}catch(t){throw new Qa(Xa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new np(Ec.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class sp{constructor(t){this._methodName=t}}class rp{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Qa(Xa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Qa(Xa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return hc(this._lat,t._lat)||hc(this._long,t._long)}}const ip=/^__.*__$/;class op{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new eh(t,this.data,this.fieldMask,e,this.fieldTransforms):new th(t,this.data,e,this.fieldTransforms)}}function ap(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ga()}}class cp{constructor(t,e,n,s,r,i){this.settings=t,this.databaseId=e,this.k=n,this.ignoreUndefinedProperties=s,void 0===r&&this.ka(),this.fieldTransforms=r||[],this.fieldMask=i||[]}get path(){return this.settings.path}get xa(){return this.settings.xa}$a(t){return new cp(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Fa(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.$a({path:n,Oa:!1});return s.Ma(t),s}La(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.$a({path:n,Oa:!1});return s.ka(),s}Ba(t){return this.$a({path:void 0,Oa:!0})}Ua(t){return wp(t,this.settings.methodName,this.settings.qa||!1,this.path,this.settings.Ka)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}ka(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ma(this.path.get(t))}Ma(t){if(0===t.length)throw this.Ua("Document fields must not be empty");if(ap(this.xa)&&ip.test(t))throw this.Ua('Document fields cannot begin and end with "__"')}}class up{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.k=n||ld(t)}ja(t,e,n,s=!1){return new cp({xa:t,methodName:e,Ka:n,path:bc.emptyPath(),Oa:!1,qa:s},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function hp(t){const e=t._freezeSettings(),n=ld(t._databaseId);return new up(t._databaseId,!!e.ignoreUndefinedProperties,n)}function lp(t,e,n,s,r,i={}){const o=t.ja(i.merge||i.mergeFields?2:0,e,n,r);mp("Data must be an object, but it was:",o,s);const a=fp(s,o);let c,u;if(i.merge)c=new Tc(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const t=[];for(const s of i.mergeFields){const r=gp(e,s,n);if(!o.contains(r))throw new Qa(Xa.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);bp(t,r)||t.push(r)}c=new Tc(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new op(new zc(a),c,u)}function dp(t,e){if(pp(t=E(t)))return mp("Unsupported field value:",e,t),fp(t,e);if(t instanceof sp)return function(t,e){if(!ap(e.xa))throw e.Ua(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Ua(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Oa&&4!==e.xa)throw e.Ua("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const r of t){let t=dp(r,e.Ba(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=E(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Du(e.k,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=dc.fromDate(t);return{timestampValue:Uh(e.k,n)}}if(t instanceof dc){const n=new dc(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uh(e.k,n)}}if(t instanceof rp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof np)return{bytesValue:Fh(e.k,t._byteString)};if(t instanceof zf){const n=e.databaseId,s=t.firestore._databaseId;if(!s.isEqual(n))throw e.Ua(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Bh(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Ua(`Unsupported field value: ${qf(t)}`)}(t,e)}function fp(t,e){const n={};return gc(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mc(t,((t,s)=>{const r=dp(s,e.Fa(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function pp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof dc||t instanceof rp||t instanceof np||t instanceof zf||t instanceof sp)}function mp(t,e,n){if(!pp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const s=qf(n);throw"an object"===s?e.Ua(t+" a custom object"):e.Ua(t+" "+s)}}function gp(t,e,n){if((e=E(e))instanceof ep)return e._internalPath;if("string"==typeof e)return vp(t,e);throw wp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const yp=new RegExp("[~\\*/\\[\\]]");function vp(t,e,n){if(e.search(yp)>=0)throw wp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ep(...e.split("."))._internalPath}catch(s){throw wp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wp(t,e,n,s,r){const i=s&&!s.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new Qa(Xa.INVALID_ARGUMENT,a+t+c)}function bp(t,e){return t.some((t=>t.isEqual(e)))}class Tp{constructor(t,e,n,s,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new zf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Ep(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Ip("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Ep extends Tp{data(){return super.data()}}function Ip(t,e){return"string"==typeof e?vp(t,e):e instanceof ep?e._internalPath:e._delegate._internalPath}class _p{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class kp extends Tp{constructor(t,e,n,s,r,i){super(t,e,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Sp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Ip("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Sp extends kp{data(t={}){return super.data(t)}}class Ap{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new _p(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Sp(this._firestore,this._userDataWriter,n.key,n,new _p(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Qa(Xa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>({type:"added",doc:new Sp(t._firestore,t._userDataWriter,n.doc.key,n.doc,new _p(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++})))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const s=new Sp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new _p(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,i=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),i=n.indexOf(e.doc.key)),{type:Cp(e.type),doc:s,oldIndex:r,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Cp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ga()}}class Np{}class Rp extends Np{constructor(t,e){super(),this.Ga=t,this.Ja=e,this.type="orderBy"}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new Qa(Xa.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Qa(Xa.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new lu(e,n);return function(t,e){if(null===wu(t)){const n=bu(t);null!==n&&function(t,e,n){if(!n.isEqual(e))throw new Qa(Xa.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}(0,n,e.field)}}(t,s),s}(t._query,this.Ga,this.Ja);return new Gf(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new mu(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}class Lp extends Np{constructor(t,e,n){super(),this.type=t,this.Ya=e,this.Xa=n}_apply(t){return new Gf(t.firestore,t.converter,Iu(t._query,this.Ya,this.Xa))}}class Dp extends class{convertValue(t,e="none"){switch(Oc(t)){case 0:return null;case 1:return t.booleanValue;case 2:return kc(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Sc(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ga()}}convertObject(t,e){const n={};return mc(t.fields,((t,s)=>{n[t]=this.convertValue(s,e)})),n}convertGeoPoint(t){return new rp(kc(t.latitude),kc(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Cc(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Nc(t));default:return null}}convertTimestamp(t){const e=_c(t);return new dc(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=vc.fromString(t);Wa(cl(n));const s=new Uf(n.get(1),n.get(3)),r=new Dc(n.popFirst(5));return s.isEqual(e)||Ha(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new np(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new zf(this.firestore,null,e)}}function Op(t,e){return function(t,e){const n=new Ya;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const s=Cf(t);try{const t=await function(t,e){const n=Ja(t),s=dc.now(),r=e.reduce(((t,e)=>t.add(e.key)),Eh());let i;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.Wn.vn(t,r).next((r=>{i=r;const o=[];for(const t of e){const e=Qu(t,i.get(t.key));null!=e&&o.push(new eh(t.key,e,Gc(e.value.mapValue),zu.exists(!0)))}return n.An.addMutationBatch(t,s,o,e)})))).then((t=>(t.applyToLocalDocumentSet(i),{batchId:t.batchId,changes:i})))}(s.localStore,e);s.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let s=t.Ko[t.currentUser.toKey()];s||(s=new lh(hc)),s=s.insert(e,n),t.Ko[t.currentUser.toKey()]=s}(s,t.batchId,n),await kf(s,t.changes),await Pd(s.remoteStore)}catch(t){const e=zd(t,"Failed to persist write");n.reject(e)}}(await function(t){return Pf(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Zf(t),e)}function Pp(t,e,n){const s=n.docs.get(e._key),r=new Dp(t);return new kp(t,r,e._key,s,new _p(n.hasPendingWrites,n.fromCache),e.converter)}!function(t,e=!0){ja="9.6.1",$(new I("firestore",((t,{options:n})=>{const s=t.getProvider("app").getImmediate(),r=new Yf(s,new nc(t.getProvider("auth-internal")),new oc(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),r._setSettings(n),r}),"PUBLIC")),J(Fa,"3.4.1",t),J(Fa,"3.4.1","esm2017")}();const xp=document.querySelector("body"),Mp=document.querySelector(".saveStats"),Up=document.querySelector(".profile>.routs>.signUp"),Fp=document.querySelector(".windowTop>.options>.signupBtn"),Vp=document.querySelector(".profileBtn"),jp=document.querySelector(".profile"),Bp=document.querySelectorAll(".options>.close"),qp=document.querySelectorAll(".windowTop>.move"),$p=document.querySelector(".settingsBtn"),Hp=document.querySelector(".settings"),Kp=document.querySelector(".themeSelector"),zp=document.querySelector(".profile>.routs"),Gp=document.querySelector(".text"),Wp=document.querySelector(".stats"),Jp=document.querySelector(".containerStats>.speed"),Xp=document.querySelector(".loginBtn"),Qp=document.querySelector(".profile>.routs>.signIn"),Yp=document.querySelector(".updateBtn"),Zp=document.querySelector(".profile>.routs>.update"),tm=document.querySelector(".logoutBtn"),em=document.querySelector(".info"),nm=document.querySelector(".loader"),sm=(document.querySelector(".options"),document.querySelector(".leaderBoard")),rm=document.querySelector(".leaderBoard>.content"),im=document.querySelector(".leaderBoardBtn"),om=document.querySelector(".container>.info"),am=document.querySelector(".username"),cm=document.querySelector(".textOptions"),um=document.querySelector(".nextBtn"),hm=document.querySelector(".infoPopup"),lm=document.querySelector(".mpBtn"),dm=document.querySelector(".mpContainer"),fm=document.querySelector(".joinRoom"),pm=document.querySelector(".createRoom"),mm=document.querySelector(".playArea"),gm=document.querySelector(".roomHeader"),ym=document.querySelector(".copyRoomId"),vm=document.querySelector("span.roomId");function wm(t,e){if(e){let n=`<span class="leaderBoardRank">${t}</span><span class="leaderBoardUserName">${e.userName}</span><span class="leaderBoardSpeed">${e.speed}</span>`,s=document.createElement("li");s.innerHTML=n,s.classList.add("leaderBoardListItem"),rm.appendChild(s)}}const bm=function(t=W()){return H(t,"firestore").getImmediate()}(Zt);!function(t,e,n,s={}){var i;const o=(t=$f(t,Kf))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Ka("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let e,n;if("string"==typeof s.mockUserToken)e=s.mockUserToken,n=Va.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(s.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const o=s.mockUserToken.sub||s.mockUserToken.user_id;if(!o)throw new Qa(Xa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Va(o)}t._authCredentials=new ec(new Za(e,n))}}(bm,"localhost",8080);const Tm=async()=>{let t=Ss(),e=t.currentUser&&t.currentUser.uid;if(e){const t=Jf(bm,`scores/${e}`);let n=t&&await function(t){t=$f(t,zf);const e=$f(t.firestore,Yf);return function(t,e,n={}){const s=new Ya;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,s,r){const i=new Lf({next:i=>{e.enqueueAndForget((()=>Zd(t,o)));const a=i.docs.has(n);!a&&i.fromCache?r.reject(new Qa(Xa.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&i.fromCache&&s&&"server"===s.source?r.reject(new Qa(Xa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(i)},error:t=>r.reject(t)}),o=new sf(gu(n.path),i,{includeMetadataChanges:!0,wo:!0});return Yd(t,o)}(await xf(t),t.asyncQueue,e,n,s))),s.promise}(Zf(e),t._key).then((n=>Pp(e,t,n)))}(t);return n.exists()?n.data():null}return null},Em=t=>{(function(t,e,n){t=$f(t,zf);const s=$f(t.firestore,Yf),r=function(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}(t.converter,e,n);return Op(s,[lp(hp(s),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,zu.none())])})(Jf(bm,`scores/${t.uId}`),t,{merge:!0}).then(console.log("added successfully")).catch((t=>console.error("I got an error",t)))};let Im;const _m="user.data";async function km(){return navigator.onLine?await Tm():JSON.parse(localStorage.getItem(_m))}function Sm(){return JSON.parse(localStorage.getItem(_m))}function Am(t){return localStorage.setItem(_m,JSON.stringify(t)),t}function Cm(t){return localStorage.setItem(_m,JSON.stringify(t)),Em(t),t}var Nm=n(187),Rm=n(58);const Lm="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function Dm(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||Rm))return new XMLHttpRequest}catch(t){}if(!e)try{return new(Lm[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function Om(t,...e){return e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})}const Pm=setTimeout,xm=clearTimeout;function Mm(t,e){e.useNativeTimers?(t.setTimeoutFn=Pm.bind(Lm),t.clearTimeoutFn=xm.bind(Lm)):(t.setTimeoutFn=setTimeout.bind(Lm),t.clearTimeoutFn=clearTimeout.bind(Lm))}var Um=n(63);const Fm=Object.create(null);Fm.open="0",Fm.close="1",Fm.ping="2",Fm.pong="3",Fm.message="4",Fm.upgrade="5",Fm.noop="6";const Vm=Object.create(null);Object.keys(Fm).forEach((t=>{Vm[Fm[t]]=t}));const jm={type:"error",data:"parser error"},Bm="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),qm="function"==typeof ArrayBuffer,$m=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)},Hm=({type:t,data:e},n,s)=>{return Bm&&e instanceof Blob?n?s(e):$m(e,s):qm&&(e instanceof ArrayBuffer||(r=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?n?s(e):$m(new Blob([e]),s):s(Fm[t]+(e||""));var r};for(var Km="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zm="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Gm=0;Gm<Km.length;Gm++)zm[Km.charCodeAt(Gm)]=Gm;const Wm="function"==typeof ArrayBuffer,Jm=(t,e)=>{if(Wm){const n=function(t){var e,n,s,r,i,o=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var u=new ArrayBuffer(o),h=new Uint8Array(u);for(e=0;e<a;e+=4)n=zm[t.charCodeAt(e)],s=zm[t.charCodeAt(e+1)],r=zm[t.charCodeAt(e+2)],i=zm[t.charCodeAt(e+3)],h[c++]=n<<2|s>>4,h[c++]=(15&s)<<4|r>>2,h[c++]=(3&r)<<6|63&i;return u}(t);return Xm(n,e)}return{base64:!0,data:t}},Xm=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t,Qm=(t,e)=>{if("string"!=typeof t)return{type:"message",data:Xm(t,e)};const n=t.charAt(0);return"b"===n?{type:"message",data:Jm(t.substring(1),e)}:Vm[n]?t.length>1?{type:Vm[n],data:t.substring(1)}:{type:Vm[n]}:jm},Ym=String.fromCharCode(30);class Zm extends Um.Q{constructor(t){super(),this.writable=!1,Mm(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,super.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(t){const e=Qm(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emit("packet",t)}onClose(){this.readyState="closed",super.emit("close")}}var tg=n(281),eg=n(830);class ng extends Zm{constructor(){super(...arguments),this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){((t,e)=>{const n=t.split(Ym),s=[];for(let t=0;t<n.length;t++){const r=Qm(n[t],e);if(s.push(r),"error"===r.type)break}return s})(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const n=t.length,s=new Array(n);let r=0;t.forEach(((t,i)=>{Hm(t,!1,(t=>{s[i]=t,++r===n&&e(s.join(Ym))}))}))})(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=tg()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const s=eg.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}}function sg(){}const rg=null!=new Dm({xdomain:!1}).responseType;class ig extends Um.Q{constructor(t,e){super(),Mm(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=Om(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new Dm(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=ig.requestsCount++,ig.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=sg,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete ig.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}abort(){this.cleanup()}}function og(){for(let t in ig.requests)ig.requests.hasOwnProperty(t)&&ig.requests[t].abort()}ig.requestsCount=0,ig.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",og):"function"==typeof addEventListener&&addEventListener("onpagehide"in Lm?"pagehide":"unload",og,!1));const ag="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),cg=Lm.WebSocket||Lm.MozWebSocket,ug="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class hg extends Zm{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=ug?{}:Om(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=ug?new cg(t,e,n):e?new cg(t,e):new cg(t)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],s=e===t.length-1;Hm(n,this.supportsBinary,(t=>{try{this.ws.send(t)}catch(t){}s&&ag((()=>{this.writable=!0,this.emit("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=tg()),this.supportsBinary||(t.b64=1);const s=eg.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}check(){return!(!cg||"__initialize"in cg&&this.name===hg.prototype.name)}}const lg={websocket:hg,polling:class extends ng{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=rg&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new ig(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",(t=>{this.onError("xhr post error",t)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t=>{this.onError("xhr poll error",t)})),this.pollXhr=t}}};class dg extends Um.Q{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=Nm(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=Nm(e.host).host),Mm(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=eg.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=function(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new lg[t](n)}open(){let t;if(this.opts.rememberUpgrade&&dg.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(()=>{this.onClose("transport close")}))}probe(t){let e=this.createTransport(t),n=!1;dg.priorWebsocketSuccess=!1;const s=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;dg.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function r(){n||(n=!0,u(),e.close(),e=null)}const i=t=>{const n=new Error("probe error: "+t);n.transport=e.name,r(),this.emitReserved("upgradeError",n)};function o(){i("transport closed")}function a(){i("socket closed")}function c(t){e&&t.name!==e.name&&r()}const u=()=>{e.removeListener("open",s),e.removeListener("error",i),e.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};e.once("open",s),e.once("error",i),e.once("close",o),this.once("close",a),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",dg.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,s){if("function"==typeof e&&(s=e,e=void 0),"function"==typeof n&&(s=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:t,data:e,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){dg.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const s=t.length;for(;n<s;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}dg.protocol=4,dg.protocol;const fg="function"==typeof ArrayBuffer,pg=Object.prototype.toString,mg="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===pg.call(Blob),gg="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===pg.call(File);function yg(t){return fg&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||mg&&t instanceof Blob||gg&&t instanceof File}function vg(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(vg(t[e]))return!0;return!1}if(yg(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return vg(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&vg(t[e]))return!0;return!1}function wg(t){const e=[],n=t.data,s=t;return s.data=bg(n,e),s.attachments=e.length,{packet:s,buffers:e}}function bg(t,e){if(!t)return t;if(yg(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=bg(t[s],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=bg(t[s],e));return n}return t}function Tg(t,e){return t.data=Eg(t.data,e),t.attachments=void 0,t}function Eg(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=Eg(t[n],e);else if("object"==typeof t)for(const n in t)t.hasOwnProperty(n)&&(t[n]=Eg(t[n],e));return t}const Ig=5;var _g;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(_g||(_g={}));class kg{encode(t){return t.type!==_g.EVENT&&t.type!==_g.ACK||!vg(t)?[this.encodeAsString(t)]:(t.type=t.type===_g.EVENT?_g.BINARY_EVENT:_g.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==_g.BINARY_EVENT&&t.type!==_g.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}encodeAsBinary(t){const e=wg(t),n=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(n),s}}class Sg extends Um.Q{constructor(){super()}add(t){let e;if("string"==typeof t)e=this.decodeString(t),e.type===_g.BINARY_EVENT||e.type===_g.BINARY_ACK?(this.reconstructor=new Ag(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else{if(!yg(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===_g[n.type])throw new Error("unknown packet type "+n.type);if(n.type===_g.BINARY_EVENT||n.type===_g.BINARY_ACK){const s=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const r=t.substring(s,e);if(r!=Number(r)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(e+1)){const s=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(s,e)}else n.nsp="/";const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const s=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!Sg.isPayloadValid(n.type,s))throw new Error("invalid payload");n.data=s}return n}static isPayloadValid(t,e){switch(t){case _g.CONNECT:return"object"==typeof e;case _g.DISCONNECT:return void 0===e;case _g.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case _g.EVENT:case _g.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case _g.ACK:case _g.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class Ag{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=Tg(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Cg(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Ng=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Rg extends Um.Q{constructor(t,e,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Cg(t,"open",this.onopen.bind(this)),Cg(t,"packet",this.onpacket.bind(this)),Cg(t,"error",this.onerror.bind(this)),Cg(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Ng.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:_g.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,s=e.pop();this._registerAckCallback(t,s),n.id=t}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?this.packet(n):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const s=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this.packet({type:_g.CONNECT,data:t})})):this.packet({type:_g.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case _g.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _g.EVENT:case _g.BINARY_EVENT:this.onevent(t);break;case _g.ACK:case _g.BINARY_ACK:this.onack(t);break;case _g.DISCONNECT:this.ondisconnect();break;case _g.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...s){n||(n=!0,e.packet({type:_g.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>this.packet(t))),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_g.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var Lg=n(10);class Dg extends Um.Q{constructor(e,n){var s;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(n=e,e=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,Mm(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(s=n.randomizationFactor)&&void 0!==s?s:.5),this.backoff=new Lg({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=e;const r=n.parser||t;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new dg(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=Cg(e,"open",(function(){n.onopen(),t&&t()})),r=Cg(e,"error",(e=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;0===t&&s();const n=this.setTimeoutFn((()=>{s(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(s),this.subs.push(r),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Cg(t,"ping",this.onping.bind(this)),Cg(t,"data",this.ondata.bind(this)),Cg(t,"error",this.onerror.bind(this)),Cg(t,"close",this.onclose.bind(this)),Cg(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new Rg(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Og={};function Pg(t,e){"object"==typeof t&&(e=t,t=void 0);const n=function(t,e="",n){let s=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),s=Nm(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const r=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+r+":"+s.port+e,s.href=s.protocol+"://"+r+(n&&n.port===s.port?"":":"+s.port),s}(t,(e=e||{}).path||"/socket.io"),s=n.source,r=n.id,i=n.path,o=Og[r]&&i in Og[r].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||o?a=new Dg(s,e):(Og[r]||(Og[r]=new Dg(s,e)),a=Og[r]),n.query&&!e.query&&(e.query=n.queryKey),a.socket(n.path,e)}function xg(t,e){hm.classList.toggle("hide"),hm.classList.remove("fadeOut"),hm.innerHTML=t,setTimeout((()=>{hm.classList.add("fadeOut"),setTimeout((()=>{hm.classList.add("hide")}),200)}),e),document.addEventListener("click",(()=>{hm.classList.contains("hide")||(hm.classList.add("fadeOut"),setTimeout((()=>{hm.classList.add("hide")}),200))}))}Object.assign(Pg,{Manager:Dg,Socket:Rg,io:Pg,connect:Pg});let Mg=!1,Ug=!0,Fg="dark";var Vg=!1,jg=!1;const Bg=Pg("http://localhost:3000");let qg;Bg.on("connect",(()=>{console.log("connection established")})),Bg.on("disconnect",(()=>{console.log("you are disconnected")})),Bg.on("roomId",(t=>{fm.classList.add("hide"),gm.classList.remove("hide"),gm.children[1].innerText=t,Vg=!0,Gp.innerText="..."})),Bg.on("unknownCode",(()=>{xg("not a valid room ",1e3)})),Bg.on("tooManyPlayers",(()=>{xg("room is full ",1e3)})),Bg.on("playerList",(t=>{let e=t.findIndex((t=>t.id==Bg.id));-1!==e&&(qg=t[e]),function(t){!function(){for(;mm.firstChild;)mm.firstChild.remove()}(),t.forEach((t=>{let e=`<div class="playerName">${t.name}</div>\n          <progress class="playerProgress" value="${t.progress}" max="100"></progress>\n          <div class="playerSpeed">${t.speed}</div>`,n=document.createElement("span");n.innerHTML=e,n.classList.add("player"),mm.appendChild(n)})),mm.classList.remove("hide")}(t)})),Bg.on("newText",(t=>{!async function(t){zg=Gp.innerText=t,oy(),ny(Gp),Kg(zg)}(t)})),Bg.on("textTimer",(()=>{let t=5,e=setInterval((()=>{xg(`text in ${t--} seconds`,500)}),1e3);setTimeout((()=>{jg&&Wg(),clearInterval(e)}),5e3)}));const $g=Bg;var Hg;const Kg=t=>{let e,n,s=!0,r=t,i=0,o=0,a=document.querySelectorAll(".text>span");a[i].classList.add("blink"),document.addEventListener("keypress",(c=>{if(c.key===r[0]){if(s&&(e=(new Date).getTime(),s=!1),r=r.substr(1),a[i].classList.add("correctWord"),a[i].classList.remove("blink"),i<t.length-1&&a[i+1].classList.add("blink")," "==r[0]||null==r[0]){++o,oy(o);let t=Math.ceil(o/ty*100),n=(new Date).getTime();n=(n-e)/1e3;var u=n.toPrecision(2)/60;let s=ty/u,r=Math.floor(s.toPrecision(3));Vg&&function(t,e){e<150?Bg.emit("typing",{...qg,progress:t,speed:e}):Bg.emit("typing",{...qg,progress:t,speed:""})}(t,r)}i==t.length-1&&(n=(new Date).getTime(),(async(t,e)=>{let n=t/(e.toPrecision(2)/60);Hg=Math.floor(n.toPrecision(3)),Jp.innerText=Hg;let s=await km();s&&Hg>s.topSpeed?(s={...s,topSpeed:Hg},console.log("setUserData called"),Cm(s)):s&&Am({...s,lastSpeed:Hg}),Vg||jg||(om.classList.toggle("hide"),om.classList.toggle("fadeOut"),setTimeout((()=>{Jg(),om.classList.toggle("fadeOut"),setTimeout((()=>{om.classList.toggle("hide")}),500)}),500))})(ty,(n-e)/1e3)),i++}else null!=a[i]&&a[i].classList.add("wrongWord")}))};var zg;let Gg=0;async function Wg(){jg&&$g.emit("getText",vm.innerText)}const Jg=async()=>{await km()||(Gg++,5!=Gg&&15!=Gg||xg("Login to save data ",1e4));let t=await fetch("https://api.quotable.io/random").then((t=>t.json())).then((t=>t.content)).catch((t=>{console.error(t.message),Gp.innerText="check your network connection"})),e=Sm();e.punctuationMode||(t=t.replace(/[^ \w]/g,"")),e.smallCaseMode&&(t=t.toLowerCase()),zg=Gp.innerText=t,oy(),ny(Gp),Kg(zg)};function Xg(t){t?(tm.classList.remove("hide"),Yp.classList.remove("hide"),Fp.classList.add("hide"),Xp.classList.add("hide")):(tm.classList.add("hide"),Yp.classList.add("hide"),Fp.classList.remove("hide"),Xp.classList.remove("hide"))}Xg();const Qg=(t,e)=>{zp.childNodes.forEach((n=>{n.classList&&(n==t?(n.classList.remove("hide"),n.classList.contains("stats")&&e?Mp.classList.remove("hide"):Mp.classList.add("hide")):!n.classList.contains("hide")&&n.classList.add("hide"))}))};n(162);var Yg=n(306),Zg=n.n(Yg);var ty;const ey=document.querySelector(".words"),ny=t=>{let e=[];for(let t=0;t<zg.length;t++)e.push(`<span>${zg[t]}</span>`);let n=e.join("");t.innerHTML=n};Vp.addEventListener("click",(async()=>{if(jp.classList.contains("hide")){jp.classList.toggle("hide");let t=await km();Xg(t),!t||0===Object.entries(t).length&&t.constructor===Object?Qg(em):(ry(t),Yp.classList.remove("hide"),Fp.classList.add("hide"))}else jp.classList.add("hide")})),Bp.forEach((t=>{t.addEventListener("click",(t=>{let e=t.target.parentElement.parentElement.parentElement;Qg(nm),e.classList.toggle("hide")}))})),qp.forEach((t=>{t.addEventListener("drag",(t=>{t.target.parentElement.parentElement.style.filter="brightness(.7)"}))})),qp.forEach((t=>{t.addEventListener("dragend",(t=>{let e=t.target.parentElement.parentElement;e.style.filter="brightness(1)",sy(t,e)}))}));const sy=(t,e)=>{e.style.left=t.pageX-20+"px",e.style.top=t.pageY-20+"px"},ry=async t=>(!t||0===Object.entries(t).length&&t.constructor===Object?Qg(em):(Wp.lastElementChild.lastElementChild.childNodes.forEach((e=>{e.classList&&(e.classList.contains("name")?(t.userName.length>10?e.style.fontSize=20:t.userName.length>20&&(e.style.fontSize=15),e.innerHTML=t.userName):e.classList.contains("speed")&&(t.userName.length>10&&(e.style.fontSize=30),e.innerHTML=t.topSpeed))})),Qg(Wp,t)),t);$p.addEventListener("click",(()=>{Hp.classList.toggle("hide")})),Kp.addEventListener("change",(async t=>{let e=await km();if(t.target.options.light.selected){if(xp.classList.contains("light"))return;xp.classList.remove("dark"),xp.classList.add("light"),e?Cm({...e,theme:"light"}):(e=Sm(),Am({...e,theme:"light"}))}else if(t.target.options.dark.selected){if(xp.classList.contains("dark"))return;xp.classList.remove("light"),xp.classList.add("dark"),e?Cm({...e,theme:"dark"}):(e=Sm(),Am({...e,theme:"dark"}))}})),Mp.addEventListener("click",(()=>{Zg().toBlob(Wp).then((t=>{window.saveAs(t,"stats.png")}))})),Up.addEventListener("submit",(t=>{t.preventDefault(),uy({email:t.target.email.value,username:t.target.username.value,password:t.target.password.value}),Qg(nm)})),Qp.addEventListener("submit",(t=>{t.preventDefault(),cy({email:t.target.email.value,password:t.target.password.value}),Qg(nm)})),Fp.addEventListener("click",(()=>{Qg(Up)})),Xp.addEventListener("click",(()=>{Qg(Qp)})),tm.addEventListener("click",(()=>{hy()})),Yp.addEventListener("click",(()=>{Qg(Zp)})),Zp.addEventListener("submit",(t=>{t.preventDefault();let e=t.target.username.value;e&&" "!=e[0]&&e.length>0?ly(e):console.log("enter username",e)})),im.addEventListener("click",(()=>{rm.parentElement.classList.contains("hide")?(rm.parentElement.classList.toggle("hide"),setTimeout((()=>{rm.parentElement.classList.toggle("fadeOut")}),200)):(rm.parentElement.classList.toggle("fadeOut"),setTimeout((()=>{rm.parentElement.classList.toggle("hide")}),500))})),sm.addEventListener("click",(t=>{t.target.classList.contains("leaderBoard")&&(sm.classList.toggle("fadeOut"),setTimeout((()=>{sm.classList.toggle("hide")}),200))})),cm.addEventListener("click",(async t=>{let e=await km();t.target.classList.contains("smallCase")?(t.target.classList.contains("active")?(Mg=!1,t.target.classList.remove("active")):(Mg=!0,t.target.classList.add("active")),e?Cm({...e,smallCaseMode:Mg}):(e=Sm(),Am({...e,smallCaseMode:Mg}))):t.target.classList.contains("punctuation")&&(t.target.classList.contains("active")?(Ug=!1,t.target.classList.remove("active")):(Ug=!0,t.target.classList.add("active")),e?Cm({...e,punctuationMode:Ug}):(e=Sm(),Am({...e,punctuationMode:Ug})))})),um.addEventListener("click",(()=>{Vg?Wg():Jg()}));let iy=!0;document.addEventListener("keypress",(t=>{t.getModifierState("CapsLock")&&iy&&xg("CapsLock",2e3),iy=!1})),lm.addEventListener("click",(t=>{dm.classList.contains("hide")?(dm.classList.remove("hide"),dm.classList.remove("scale0"),dm.classList.remove("fadeOut")):(dm.classList.add("scale0"),dm.classList.add("fadeOut"),setTimeout((()=>{dm.classList.add("hide")}),500))})),pm.addEventListener("click",(t=>{!async function(){let t=await km();$g.emit("createRoom",t,$g.id),jg=!0}()})),fm.addEventListener("submit",(t=>{t.preventDefault(),t.target.roomId.value&&" "!=t.target.roomId.value&&async function(t){let e=await km();$g.emit("joinRoom",e,t)}(t.target.roomId.value)})),ym.addEventListener("click",(()=>{navigator.clipboard.writeText(vm.innerHTML).then((()=>{ym.innerText="",ym.classList.add("active")}))}));const oy=(t=0)=>{let e,n=/ /g,s=[];for(;e=n.exec(zg);)s.push(e.index);ty=s.length+1,ey.innerText=`${ty}/${t}`},ay=Ss(Zt);!function(t,e,n){const s=Ze(t);ce(s._canInitEmulator,s,"emulator-config-failed"),ce(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=en(e),{host:i,port:o}=function(t){const e=en(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const t=r[1];return{host:t,port:nn(s.substr(t.length+1))}}{const[t,e]=s.split(":");return{host:t,port:nn(e)}}}(e),a=null===o?"":`:${o}`;s.config.emulator={url:`${r}//${i}${a}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:i,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:false})}),function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(ay,"http://localhost:9999");const cy=async({email:t,password:e})=>{try{await function(t,e,n){return async function(t,e){return En(Ze(t),e)}(E(t),ln.credential(e,n))}(ay,t,e)}catch(t){alert(t.code)}},uy=async({email:t,password:e,username:n})=>{try{const s=await async function(t,e,n){const s=Ze(t),r=await async function(t,e){return Ie(t,"POST","/v1/accounts:signUp",be(t,e))}(s,{returnSecureToken:!0,email:e,password:n}),i=await vn._fromIdTokenResponse(s,"signIn",r);return await s._updateCurrentUser(i.user),i}(ay,t,e);await In(s.user,{displayName:n||s.email.split("@")[0]}).then((()=>{console.log("updated the name"),Cm({uId:s.user.uid,userName:s.user.displayName,topSpeed:0,theme:Fg,punctuationMode:Ug,smallCaseMode:Mg,lastSpeed:0})}))}catch(t){alert(t.code)}},hy=()=>{try{!function(t){E(t).signOut()}(ay),console.log("user logged out")}catch(t){alert(t.code)}},ly=async t=>{try{let e=ay.currentUser;Qg(nm),await In(e,{displayName:t}).then((()=>{console.log("updated the name"),function(t){Em(t);let e=getUserTheme();localStorage.setItem(_m,JSON.stringify({...e,userName:t.username}))}({uId:e.uid,userName:e.displayName}),km().then((t=>{ry(t)}))}))}catch(t){alert("check your network")}};window.onload=()=>{if(Sm()){let t=Sm().theme;"dark"!=t&&(xp.classList.remove("dark"),xp.classList.add(t)),Kp.options[t].selected=!0,Sm().punctuationMode?cm.children[0].classList.add("active"):cm.children[0].classList.remove("active"),Sm().smallCaseMode?cm.children[1].classList.add("active"):cm.children[1].classList.remove("active"),function(t){t&&(Jp.innerText=t)}(Sm().lastSpeed)}else Am({punctuationMode:Ug,smallCaseMode:Mg,theme:Fg})},Jg(),function(t,e,n,s){E(t).onAuthStateChanged((async t=>{t?(Xg(t=await km()),ry(t),am.innerText=t.userName):(Xg(t),ry(t),am.innerText=" ")}),void 0,void 0)}(ay),function(){const t=function(t,e,...n){if(t=E(t),Vf("collection","path",e),t instanceof Kf){const s=vc.fromString(e,...n);return Bf(s),new Wf(t,null,s)}{if(!(t instanceof zf||t instanceof Wf))throw new Qa(Xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(vc.fromString(e,...n));return Bf(s),new Wf(t.firestore,null,s)}}(bm,"scores"),e=function(t,...e){for(const n of e)t=n._apply(t);return t}(t,function(t,e="asc"){const n=e,s=Ip("orderBy","topSpeed");return new Rp(s,n)}(0,"desc"),(function(t,e){if(e<=0)throw new Qa(Xa.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}("limit",10),new Lp("limit",10,"F")));Im=function(t,...e){var n,s,r;t=E(t);let i={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Qf(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Qf(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(s=t.error)||void 0===s?void 0:s.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let c,u,h;if(t instanceof zf)u=$f(t.firestore,Yf),h=gu(t._key.path),c={next:n=>{e[o]&&e[o](Pp(u,t,n))},error:e[o+1],complete:e[o+2]};else{const n=$f(t,Gf);u=$f(n.firestore,Yf),h=n._query;const s=new Dp(u);c={next:t=>{e[o]&&e[o](new Ap(u,s,n,t))},error:e[o+1],complete:e[o+2]},function(t){if(vu(t)&&0===t.explicitOrderBy.length)throw new Qa(Xa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,s){const r=new Lf(s),i=new sf(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>Yd(await xf(t),i))),()=>{r.na(),t.asyncQueue.enqueueAndForget((async()=>Zd(await xf(t),i)))}}(Zf(u),h,a,c)}(e,t,(t=>{if(t){const e=[];!function(){for(;rm.firstChild;)rm.firstChild.remove()}(),function(){let t=document.createElement("li");t.classList.add("leaderBoardHeader"),t.innerText="leaderboard";let e=document.createElement("li");e.classList.add("leaderBoardInfo"),e.innerHTML='<span class="leaderBoardRank">Rank</span><span class="leaderBoardUserName">Username</span><span class="leaderBoardSpeed">Top Speed</span>',rm.appendChild(t),rm.appendChild(e)}(),t.forEach((t=>{let n=t.data();n.topSpeed>0&&e.push({userName:n.userName,speed:n.topSpeed})}));for(let t=0;t<e.length;t++)wm(t+1,e[t])}else console.log("could not find leaderBoard"),alert("no leaderboard found due to some error")}))}()})()})();